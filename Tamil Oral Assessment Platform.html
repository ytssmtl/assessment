<!DOCTYPE html>
<html lang="ta-MY">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>G3 родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
--font-display: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
--font-ui: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
--font-text: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
--font-numbers: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
--primary-50: #eff6ff;
--primary-100: #dbeafe;
--primary-500: #3b82f6;
--primary-600: #2563eb;
--primary-700: #1d4ed8;
--semantic-success: #059669;
--semantic-warning: #d97706;
--semantic-error: #dc2626;
--semantic-info: #0369a1;
--semantic-secondary: #10b981;
--semantic-secondary-dark: #0da271;
--gray-50: #f8fafc;
--gray-100: #f1f5f9;
--gray-200: #e2e8f0;
--gray-300: #cbd5e1;
--gray-400: #94a3b8;
--gray-600: #475569;
--gray-700: #334155;
--gray-800: #1e293b;
--gray-900: #0f172a;
--space-0: 0;
--space-1: 0.25rem;
--space-2: 0.5rem;
--space-3: 0.75rem;
--space-4: 1rem;
--space-5: 1.25rem;
--space-6: 1.5rem;
--space-8: 2rem;
--space-10: 2.5rem;
--space-12: 3rem;
--text-xs: 0.75rem;
--text-sm: 0.875rem;
--text-base: 1rem;
--text-lg: 1.125rem;
--text-xl: 1.25rem;
--text-2xl: 1.5rem;
--text-3xl: 1.8rem;
--radius-sm: 0.25rem;
--radius: 0.5rem;
--radius-lg: 0.75rem;
--radius-xl: 1rem;
--shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
--shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
--shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}
/* ========== щ╜┐ш╜охЫ╛цаЗца╖х╝П ========== */
.gear-icon {
position: absolute !important;
top: 15px !important;
left: 20px !important;
transform: none !important;
width: 20px;
height: 20px;
cursor: pointer;
z-index: 10;
display: flex;
align-items: center;
justify-content: center;
font-size: 18px;
color: rgba(255,255,255,0.4);
transition: all 0.3s ease;
user-select: none;
-webkit-tap-highlight-color: transparent;
}
.gear-icon:hover {
color: rgba(255,255,255,0.8);
}
.progress-ring {
position: absolute;
top: -10px;
left: -10px;
transform: rotate(-90deg);
opacity: 0;
transition: opacity 0.2s;
pointer-events: none;
}
.gear-icon.pressing .progress-ring {
opacity: 1;
}
.progress-ring__circle {
stroke-dasharray: 119.38;
stroke-dashoffset: 119.38;
transition: stroke-dashoffset 2s linear;
stroke: #10b981;
stroke-width: 3;
fill: transparent;
r: 19;
cx: 22;
cy: 22;
}
.gear-icon.pressing .progress-ring__circle {
stroke-dashoffset: 0;
}
.gear-icon.pressing i {
animation: gear-rotate 2s linear;
}
@keyframes gear-rotate {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
.gear-icon.activated {
color: #10b981;
animation: success-pop 0.5s ease;
}
@keyframes success-pop {
0% { transform: scale(1); }
50% { transform: scale(1.2); }
100% { transform: scale(1); }
}
/* ========== чобчРЖщЭвцЭ┐ ========== */
.admin-panel {
position: fixed;
top: 100px;
left: 20px;
width: 400px;
max-height: 80vh;
overflow-y: auto;
padding: 20px;
background: white;
border: 1px solid var(--gray-200);
border-radius: 8px;
box-shadow: var(--shadow-lg);
display: none !important;
z-index: 9999;
font-family: var(--font-ui);
}
.admin-panel.show {
display: block !important;
}
.admin-panel-header {
display: flex;
align-items: center;
justify-content: space-between;
margin-bottom: 20px;
color: var(--gray-900);
font-size: 18px;
border-bottom: 1px solid var(--gray-200);
padding-bottom: 10px;
}
.admin-close-btn {
background: var(--gray-200);
border: none;
width: 30px;
height: 30px;
border-radius: 50%;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
font-size: 16px;
color: var(--gray-600);
transition: all 0.2s;
}
.admin-close-btn:hover {
background: var(--gray-300);
color: var(--gray-800);
}
.form-group {
margin-bottom: 18px;
}
.form-group label {
display: block;
margin-bottom: 6px;
font-weight: 600;
color: var(--gray-800);
font-size: 14px;
}
.form-group input,
.form-group textarea,
.form-group select {
width: 100%;
padding: 8px 12px;
border: 1px solid var(--gray-300);
border-radius: 4px;
font-family: var(--font-ui);
font-size: 14px;
}
.form-group textarea {
resize: vertical;
min-height: 150px;
font-family: var(--font-text);
line-height: 1.6;
}
.save-btn {
background: var(--semantic-secondary);
color: white;
border: none;
padding: 12px 20px;
border-radius: 4px;
cursor: pointer;
width: 100%;
font-weight: 600;
font-size: 15px;
transition: background 0.3s ease;
}
.save-btn:hover {
background: var(--semantic-secondary-dark);
}
/* ========== хп╝хЗ║/хп╝хЕецМЙщТоч╗Д ========== */
.admin-button-group {
display: flex;
gap: 10px;
margin-top: 10px;
}
.admin-button-group .save-btn {
flex: 1;
padding: 10px 12px;
font-size: 14px;
}
.admin-button-group .export-btn {
background: #3b82f6;
}
.admin-button-group .export-btn:hover {
background: #2563eb;
}
.admin-button-group .import-btn {
background: #8b5cf6;
}
.admin-button-group .import-btn:hover {
background: #7c3aed;
}
@media (max-width: 768px) {
.admin-button-group {
flex-direction: column;
}
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: var(--font-text);
background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
min-height: 100vh;
color: var(--gray-800);
line-height: 1.6;
padding: var(--space-4);
font-weight: 400;
font-size: var(--text-base);
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
.app-container {
max-width: 1200px;
margin: 0 auto;
background: white;
border-radius: var(--radius-xl);
box-shadow: var(--shadow-lg);
overflow: visible;
}
.app-header {
background: linear-gradient(145deg, #0d2a47 0%, #1a416b 20%, #285a90 40%, #3875b6 60%, #4a92dd 80%, #5fb0ff 100%);
color: white;
padding: var(--space-8) var(--space-6);
text-align: center;
position: relative;
overflow: visible;
margin-bottom: 0;
box-shadow: 0 5px 15px rgba(13, 42, 71, 0.1);
z-index: 100;
}
.app-header::after {
content: '';
position: absolute;
bottom: 0;
left: 0;
width: 100%;
height: 10px;
background: linear-gradient(to bottom, rgba(95, 176, 255, 0.3), transparent);
z-index: 1;
}
.app-title {
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
font-weight: 700;
font-size: 32px !important;
background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
color: transparent;
margin: 0 0 8px 0;
letter-spacing: 0.5px;
}
.copyright-corner {
position: absolute;
top: 15px;
right: 20px;
color: rgba(255,255,255,0.4);
font-size: 16px;
cursor: pointer;
z-index: 2;
font-family: 'Font Awesome 6 Free', Arial, sans-serif;
font-weight: 900;
display: flex;
align-items: center;
gap: 8px;
transition: color 0.3s ease;
line-height: 1;
}
.copyright-corner:hover {
color: rgba(255,255,255,0.8);
}
.copyright-tooltip {
position: absolute;
top: 30px;
right: -10px;
width: 280px;
background-color: #ffffff !important;
border: 1px solid #ccc;
border-radius: 6px;
padding: 16px 20px;
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
opacity: 0;
visibility: hidden;
transition: opacity 0.25s ease, visibility 0.25s ease;
z-index: 999999;
font-family: var(--font-ui);
font-size: 13px;
color: #333;
line-height: 1.5;
pointer-events: auto;
display: block !important;
text-align: center;
}
.copyright-corner.show-tooltip .copyright-tooltip {
opacity: 1;
visibility: visible;
}
/* чЙИцЭГф┐бцБпцЦЗхнЧцОТхИЧ - хоМхЕицМЙчЕзхЫ╛чЙЗцОТчЙИя╝МцЧахКач▓Ч */
.copyright-tooltip-content {
display: flex;
flex-direction: column;
gap: 8px;
text-align: center;
}
.copyright-tooltip-content p {
margin: 0;
font-weight: normal;
text-align: center;
}
.copyright-tooltip-content p br {
display: block;
content: "";
margin: 0;
}
.copyright-author-text {
position: absolute;
top: 100%;
right: 0;
margin-top: 8px;
background: transparent;
color: rgba(255,255,255,0.9);
font-size: 14px;
opacity: 0;
visibility: hidden;
transition: opacity 0.2s ease, visibility 0.2s ease;
z-index: 9999;
font-family: var(--font-text);
white-space: nowrap;
pointer-events: none;
font-weight: normal;
}
.copyright-corner.show-author .copyright-author-text {
opacity: 1;
visibility: visible;
}
.student-info {
padding: var(--space-6);
background: white;
border-radius: 0 0 var(--radius-lg) var(--radius-lg);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
margin-top: -10px;
position: relative;
z-index: 2;
}
.info-grid {
display: flex;
flex-wrap: wrap;
gap: var(--space-4);
align-items: center;
justify-content: space-between;
}
.input-group {
display: flex;
align-items: center;
gap: var(--space-2);
flex: 1 1 200px;
min-width: 200px;
}
.input-label {
font-family: var(--font-ui);
font-weight: 400;
font-size: 0.95rem;
color: var(--gray-700);
white-space: nowrap;
display: flex;
align-items: center;
gap: 4px;
}
.input-label i {
font-size: 0.95rem;
color: var(--gray-600);
}
.input-field {
flex: 1;
padding: var(--space-2) var(--space-3);
border: 2px solid var(--gray-200);
border-radius: var(--radius);
font-size: 0.95rem;
font-family: var(--font-numbers);
font-weight: 400;
width: 100%;
min-width: 0;
}
/* чз╗щЩдхНаф╜НцЦЗхнЧ */
.input-field::placeholder {
color: transparent;
}
.main-content {
padding: var(--space-6);
}
.section {
background: white;
border-radius: var(--radius-lg);
padding: var(--space-6);
margin-bottom: var(--space-6);
border: 1px solid var(--gray-200);
}
.section-title {
font-family: var(--font-display);
font-weight: 600;
font-size: 1.4rem;
margin-bottom: var(--space-4);
padding-bottom: var(--space-2);
border-bottom: 2px solid var(--gray-100);
display: flex;
align-items: center;
gap: var(--space-3);
}
.section-title i {
font-size: 1.2rem;
color: var(--primary-600);
}
.reading-title {
display: flex;
align-items: center;
justify-content: space-between;
}
.title-content {
display: flex;
align-items: center;
gap: var(--space-3);
}
.delete-marks-btn {
padding: var(--space-2);
background: transparent;
color: var(--gray-500);
border: none;
border-radius: var(--radius);
cursor: pointer;
font-size: 1rem;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.2s;
font-family: var(--font-ui);
font-weight: 400;
}
.delete-marks-btn i {
font-size: 1rem;
}
.delete-marks-btn:hover {
color: var(--semantic-error);
background: var(--gray-100);
}
.reading-layout {
display: grid;
grid-template-columns: 2fr 1fr;
gap: var(--space-6);
align-items: stretch;
}
.passage-column, .comments-column {
display: flex;
flex-direction: column;
}
.passage-container {
background: var(--gray-50);
border-radius: var(--radius);
padding: var(--space-4);
position: relative;
height: 100%;
min-height: 450px;
border: 1px solid var(--gray-200);
display: flex;
align-items: center;
justify-content: center;
}
/* цЬЧшп╗чпЗчлаф╜┐чФи Arial Unicode MS хнЧф╜Уя╝МцЧах░ПхЬЖхЬИя╝Мф╕дчлпхп╣щ╜Р */
.passage-text {
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
font-weight: 400;
line-height: 1.6;
font-size: 1rem;
background: white;
padding: var(--space-4);
border-radius: var(--radius);
border: 1px solid var(--gray-200);
white-space: pre-wrap;
user-select: none;
width: 100%;
max-height: 100%;
overflow: auto;
letter-spacing: normal;
text-align: justify;
text-justify: inter-ideograph;
}
/* хКахдзцо╡шР╜щЧ┤ш╖Эя╝МшойхИЖцо╡цЫ┤цШОцШ╛ */
.passage-text p {
margin: 0 0 1rem 0;
line-height: 1.6;
text-align: justify;
text-justify: inter-ideograph;
display: block;
}
.passage-text p:last-child {
margin-bottom: 0;
}
/* чз╗щЩдхНХшпНхСихЫ┤чЪДхЬЖхЬИцХИцЮЬ */
.word {
cursor: pointer;
padding: 0;
border-radius: 0;
display: inline;
position: static;
transition: all 0.2s;
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
font-weight: 400;
font-size: 1rem;
letter-spacing: normal;
background: transparent !important;
border: none !important;
box-shadow: none !important;
}
.word.mistake {
text-decoration: underline;
text-decoration-color: #b91c1c;
text-decoration-thickness: 1px;
text-underline-offset: 2px;
}
.word.highlighted {
background: rgba(255, 0, 0, 0.15);
}
.number-in-passage {
font-family: var(--font-numbers) !important;
font-weight: 500 !important;
font-size: 1em !important;
position: relative !important;
top: 0.05em !important;
}
.number-in-passage.mistake {
text-decoration: underline !important;
text-decoration-color: #b91c1c !important;
text-decoration-thickness: 1px !important;
text-underline-offset: 2px !important;
}
.number-in-passage.highlighted {
background: rgba(255, 0, 0, 0.15) !important;
}
.comments-column {
background: var(--gray-50);
border-radius: var(--radius);
padding: var(--space-5);
border: 1px solid var(--gray-200);
gap: var(--space-5);
height: 100%;
min-height: 450px;
}
.textarea-group {
margin: 0;
position: relative;
}
.textarea-group .text-format-container {
display: flex;
flex-direction: column;
border-radius: var(--radius);
border: 2px solid var(--gray-200);
overflow: hidden;
background: white;
}
.textarea-group label {
font-size: 1rem;
font-weight: 400;
margin-bottom: var(--space-2);
display: block;
font-family: var(--font-ui);
color: var(--gray-700);
display: flex;
align-items: center;
gap: 8px;
}
.textarea-group label i {
color: var(--primary-600);
font-size: 1em;
}
.text-format-container .format-toolbar {
background: var(--gray-100);
border-bottom: 1px solid var(--gray-300);
padding: 4px 6px;
display: flex;
gap: 4px;
flex-wrap: wrap;
flex-shrink: 0;
min-height: 34px;
}
.format-btn {
background: white;
border: 1px solid var(--gray-300);
border-radius: 3px;
padding: 3px 6px;
cursor: pointer;
font-family: var(--font-ui);
font-size: 11px;
display: flex;
align-items: center;
gap: 3px;
transition: all 0.2s;
white-space: nowrap;
}
.format-btn:hover {
background: var(--gray-100);
border-color: var(--gray-400);
}
.format-btn.active {
background: var(--primary-100);
border-color: var(--primary-300);
color: var(--primary-700);
}
.format-toolbar .toolbar-divider {
width: 1px;
height: 18px;
background: var(--gray-300);
margin: 0 4px;
}
.editable-content i.fas, .editable-content i.far {
color: var(--primary-600);
margin-right: 4px;
display: inline-block;
}
.editable-content {
width: 100%;
padding: var(--space-3);
border: none;
font-size: 1rem;
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
font-weight: 400;
resize: vertical;
line-height: 1.5;
min-height: 70px;
outline: none;
background: transparent;
overflow-y: auto;
cursor: text;
}
.editable-content:focus {
background: var(--primary-50);
}
.editable-content[placeholder]:empty:before {
content: attr(placeholder);
color: var(--gray-400);
cursor: text;
}
.editable-content b, .editable-content strong {
font-weight: bold;
}
.editable-content i, .editable-content em {
font-style: italic;
}
.editable-content u {
text-decoration: underline;
}
.editable-content ol {
padding-left: 24px;
margin: 4px 0;
}
.editable-content ul {
padding-left: 24px;
margin: 4px 0;
}
.editable-content ul li {
list-style-type: disc;
}
.editable-content ol li {
list-style-type: decimal;
}
#readingComment {
min-height: 100px;
max-height: 120px;
}
.quick-phrase-menu {
position: absolute;
background: white;
border: 1px solid var(--gray-300);
border-radius: 4px;
box-shadow: var(--shadow-md);
z-index: 1001;
min-width: 180px;
max-height: 300px;
overflow-y: auto;
display: none;
}
.quick-phrase-item {
padding: 6px 10px;
cursor: pointer;
font-family: var(--font-ui);
font-size: 12px;
display: flex;
align-items: center;
gap: 8px;
}
.quick-phrase-item:hover {
background: var(--gray-100);
}
.score-card {
background: white;
border-radius: var(--radius);
padding: var(--space-4);
border: 2px solid var(--gray-200);
margin-top: 0;
box-shadow: var(--shadow-sm);
}
.score-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: var(--space-3);
}
.score-header > div:first-child {
font-size: 1rem;
font-weight: 400;
font-family: var(--font-ui);
color: var(--gray-800);
padding-left: 4px;
display: flex;
align-items: center;
gap: 8px;
}
.score-header > div:first-child i {
color: var(--primary-600) !important;
font-size: 1rem;
}
.score-value {
font-family: var(--font-numbers);
font-weight: 400;
font-size: 1.7rem;
color: var(--primary-600);
}
.score-value:empty:before,
.score-value[data-initial="true"] {
content: "0";
}
.score-level {
display: flex;
align-items: center;
margin: var(--space-3) 0;
}
.level-label {
font-family: var(--font-ui);
font-weight: 400;
width: 55px;
font-size: 0.95rem;
color: var(--gray-700);
}
.score-buttons {
display: flex;
gap: var(--space-2);
flex-wrap: wrap;
flex: 1;
}
.score-btn {
font-family: var(--font-ui);
font-weight: 400;
flex: 1;
min-width: 40px;
padding: var(--space-1) var(--space-1);
border: 2px solid var(--gray-300);
background: white;
border-radius: var(--radius);
cursor: pointer;
text-align: center;
font-size: 0.95rem;
}
.score-btn.selected {
background: var(--primary-500);
color: white;
border-color: var(--primary-500);
}
.scoring-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
gap: var(--space-5);
margin: var(--space-5) 0;
}
.question {
margin: var(--space-5) 0;
padding: var(--space-4);
background: var(--gray-50);
border-radius: var(--radius);
border-left: 3px solid #3875b6;
}
.question p {
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
font-weight: 400;
margin-bottom: var(--space-3);
font-size: 1rem;
line-height: 1.5;
color: var(--gray-800);
}
.context-menu {
position: absolute;
background: white;
border: 1px solid var(--gray-300);
border-radius: 4px;
box-shadow: var(--shadow-md);
z-index: 1000;
min-width: 160px;
display: none;
}
.context-menu-item {
padding: 6px 10px;
cursor: pointer;
font-family: var(--font-ui);
font-size: 13px;
display: flex;
align-items: center;
gap: 8px;
}
.context-menu-item:hover {
background: var(--gray-100);
}
.context-menu-divider {
height: 1px;
background: var(--gray-300);
margin: 4px 0;
}
.action-bar {
display: flex !important;
flex-direction: column !important;
gap: var(--space-5);
justify-content: center;
align-items: center;
flex-wrap: wrap;
margin: var(--space-6) 0;
padding: var(--space-5);
background: var(--gray-50);
border-radius: var(--radius-lg);
border: 1px solid var(--gray-200);
}
.action-buttons-row {
display: flex;
flex-wrap: wrap;
gap: var(--space-3);
justify-content: center;
width: 100%;
max-width: 900px;
}
.action-btn {
font-family: var(--font-ui);
font-weight: 400;
padding: var(--space-3) var(--space-5);
border: none;
border-radius: var(--radius);
font-size: 1rem;
cursor: pointer;
display: flex;
align-items: center;
gap: var(--space-2);
min-width: 160px;
justify-content: center;
flex-shrink: 0;
transition: all 0.2s ease;
}
.action-btn i {
font-size: 1.1rem;
}
.btn-primary {
background: var(--primary-600);
color: white;
}
.btn-primary:hover {
background: var(--primary-700);
}
.btn-revision {
background: linear-gradient(145deg, var(--semantic-secondary), var(--semantic-secondary-dark));
color: white;
}
.btn-revision:hover {
background: linear-gradient(145deg, var(--semantic-secondary-dark), #0b8a5e);
}
.btn-warning {
background: var(--semantic-warning);
color: white;
}
.btn-warning:hover {
background: #b45309;
}
.btn-print-simple {
background: #8b5cf6;
color: white;
}
.btn-print-simple:hover {
background: #7c3aed;
}
.btn-success {
background: var(--semantic-success);
color: white;
}
.btn-danger {
background: var(--semantic-error);
color: white;
}
.revision-bottom-bar {
background: white;
padding: var(--space-6) var(--space-5);
border-radius: var(--radius-lg);
border: 1px solid var(--gray-200);
margin-top: var(--space-5);
text-align: center;
display: none;
}
.revision-buttons {
display: flex;
gap: var(--space-5);
justify-content: center;
max-width: 900px;
margin: 0 auto;
flex-wrap: wrap;
}
.revision-buttons .action-btn {
min-width: 180px;
padding: var(--space-3) var(--space-6);
font-size: 1rem;
}
.revision-mode #mainActionBar,
.revision-mode #criteria-btn,
.revision-mode #recordsSection {
display: none !important;
}
.revision-mode .input-field,
.revision-mode .editable-content,
.revision-mode .score-btn {
background-color: #f0f9ff !important;
border-color: var(--semantic-secondary) !important;
box-shadow: 0 0 0 1px rgba(16, 185, 129, 0.2) !important;
}
.revision-mode .score-btn.selected {
background: var(--semantic-secondary) !important;
border-color: var(--semantic-secondary) !important;
}
.revision-modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.7);
z-index: 9999;
display: flex;
align-items: center;
justify-content: center;
}
.revision-modal-content {
background: white;
padding: 25px;
border-radius: 10px;
max-width: 800px;
width: 90%;
max-height: 80vh;
overflow-y: auto;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}
.revision-modal h3 {
margin: 0 0 15px 0;
text-align: center;
color: #333;
font-family: var(--font-display);
font-weight: 600;
}
.revision-student-table {
width: 100%;
border-collapse: collapse;
margin-bottom: 20px;
font-size: 0.95rem;
}
.revision-student-table th {
background: var(--gray-50);
padding: 8px 6px;
text-align: left;
font-family: var(--font-ui);
font-weight: 400;
color: var(--gray-800);
border-bottom: 2px solid var(--gray-200);
}
.revision-student-table td {
padding: 8px 6px;
border-bottom: 1px solid var(--gray-100);
font-family: var(--font-numbers);
font-weight: 400;
}
.revision-edit-btn {
background: var(--semantic-secondary);
color: white;
border: none;
border-radius: var(--radius-sm);
padding: 4px 10px;
cursor: pointer;
font-family: var(--font-ui);
font-weight: 400;
transition: all 0.2s;
}
.revision-edit-btn:hover {
background: var(--semantic-secondary-dark);
}
.revision-close-btn {
background: #f1f5f9;
color: #333;
border: none;
border-radius: 6px;
padding: 8px 25px;
cursor: pointer;
font-family: var(--font-ui);
font-weight: 400;
transition: all 0.2s;
font-size: 0.95rem;
}
.revision-close-btn:hover {
background: #e2e8f0;
}
.records-section {
background: white;
border-radius: var(--radius-lg);
padding: var(--space-5);
margin-top: var(--space-5);
border: 1px solid var(--gray-200);
}
.records-table {
width: 100%;
border-collapse: collapse;
margin-top: var(--space-3);
font-size: 0.95rem;
}
.records-table th {
font-family: var(--font-ui);
font-weight: 400;
background: var(--gray-50);
padding: var(--space-3);
text-align: left;
font-size: 1rem;
color: var(--gray-800);
}
.records-table td.record-text {
font-family: var(--font-text);
font-weight: 400;
padding: var(--space-3);
border-bottom: 1px solid var(--gray-100);
font-size: 0.95rem;
text-align: left;
}
.records-table td.record-number {
font-family: var(--font-numbers);
font-weight: 400;
padding: var(--space-3);
border-bottom: 1px solid var(--gray-100);
font-size: 0.95rem;
text-align: center;
}
.delete-btn {
font-family: var(--font-ui);
font-weight: 400;
background: var(--semantic-error);
color: white;
border: none;
border-radius: var(--radius-sm);
padding: var(--space-1) var(--space-3);
cursor: pointer;
font-size: 0.9rem;
}
.delete-btn:hover {
background: #b91c1c;
}
.floating-btn {
font-family: var(--font-ui);
font-weight: 400;
position: fixed;
bottom: 25px;
right: 25px;
background: var(--primary-600);
color: white;
border: none;
border-radius: 50%;
width: 56px;
height: 56px;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
font-size: 22px;
z-index: 1000;
}
.modal {
display: none;
position: fixed;
z-index: 2000;
left: 0;
top: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.6);
overflow: auto;
}
.modal-content {
background: white;
margin: 30px auto;
padding: var(--space-5);
width: 90%;
max-width: 900px;
border-radius: var(--radius-xl);
position: relative;
max-height: 85vh;
overflow-y: auto;
}
.global-close-btn {
font-family: var(--font-ui);
font-weight: 400;
position: fixed;
top: 20px;
right: 20px;
background: var(--gray-600);
color: white;
border: none;
border-radius: var(--radius);
padding: var(--space-2) var(--space-3);
cursor: pointer;
font-size: 1rem;
z-index: 2001;
display: none;
}
.global-close-btn:hover {
background: var(--gray-700);
}
.no-print {
display: block;
}
#rubricContent table td {
font-family: var(--font-numbers);
}
@media print {
body { font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif; font-size: 11pt; }
.score-value, .records-table td, .records-table td strong, .number-in-passage {
font-family: 'Arial Unicode MS', Arial, sans-serif !important;
}
.editable-content {
border: none !important;
background: transparent !important;
}
.no-print {
display: none !important;
}
@page {
margin: 12mm;
size: A4;
}
}
@media (max-width: 768px) {
.reading-layout {
grid-template-columns: 1fr;
}
.info-grid {
flex-direction: column;
align-items: stretch;
}
.input-group {
min-width: 100%;
}
}
</style>
</head>
<body>
<button class="global-close-btn no-print" id="globalCloseBtn" onclick="closeRubric()">├Ч</button>
<!-- ========== чобчРЖщЭвцЭ┐ ========== -->
<div class="admin-panel no-print" id="adminPanel">
<div class="admin-panel-header">
<h3>тЪЩя╕П родрпЗро░рпНро╡рпБродрпН родроХро╡ро▓рпНроХро│рпИ рооро╛ро▒рпНро▒рпБроХ</h3>
<button class="admin-close-btn" onclick="closeAdminPanel()" title="роорпВроЯрпБ">
<i class="fas fa-times"></i>
</button>
</div>
<div class="form-group">
<label>ЁЯУМ родро░роорпН/рокро┐ро░ро┐ро╡рпБя╝Ъ</label>
<select id="gradeStreamSelect" style="width:100%; padding:8px; border:1px solid var(--gray-300); border-radius:4px;">
<option value="S4_G3_TL">S4_G3_TL</option>
<option value="S3_G3_TL">S3_G3_TL</option>
<option value="S2_G3_TL">S2_G3_TL</option>
<option value="S1_G3_TL">S1_G3_TL</option>
</select>
</div>
<div class="form-group">
<label>ЁЯТм роЙро░рпИропро╛роЯро▓рпН ро╡ро┐ройро╛роХрпНроХро│рпНя╝Ъ</label>
<textarea id="input-conversation-prompts">1. роТро│ро┐роХрпНроХро╛роЯрпНроЪро┐ропро┐ро▓рпН роЪро┐ро▓ роироЯро╡роЯро┐роХрпНроХрпИроХро│рпН роЗроЯроорпН рокрпЖро▒рпНро▒ро┐ро░рпБроирпНродрой. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│ро┐ро▓рпН рокроЩрпНроХрпБрокрпЖро▒ роирпА ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒ро╛ропро╛? роПройрпН?
2. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│ро┐ро▓рпН роЕродро┐роХрооро╛рой рооро╛рогро╡ро░рпНроХро│рпН рокроЩрпНроХрпЗро▒рпНроХ роОро╡рпНро╡ро╛ро▒рпБ рокро│рпНро│ро┐роХро│рпН роЕро╡ро░рпНроХро│рпИ роКроХрпНроХрпБро╡ро┐роХрпНроХро▓ро╛роорпН?
3. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│рпН рооро╛рогро╡ро░рпНроХро│ро┐ройрпН рокрогрпНрокрпБроиро▓ройрпНроХро│рпИ ро╡ро│ро░рпНроХрпНроХро┐ройрпНро▒рой. роирпА роЗроХрпНроХро░рпБродрпНродро┐ройрпИ роПро▒рпНро▒рпБроХрпНроХрпКро│рпНроХро┐ро▒ро╛ропро╛? роПройрпН?</textarea>
</div>
<div class="form-group">
<label>ЁЯУЦ ро╡ро╛роЪро┐рокрпНрокрпБрокрпН рокродрпНродро┐я╝Ъ</label>
<textarea id="input-reading-passage">роТро░рпБро╡ро░родрпБ рокрпБройрпНройроХрпИ рокро┐ро▒ро░рпИроХрпН роХро╡ро░рпНроирпНродрпБ роЗро┤рпБроХрпНроХроХрпНроХрпВроЯро┐роп роЖро▒рпНро▒ро▓рпН рооро┐роХрпНроХродрпБ. родроорпН роорпБроХродрпНродро┐ро▓рпН роОрокрпНрокрпЛродрпБроорпН рокрпБройрпНройроХрпИропрпИроХрпН роХрпАро┤рпЗропрпЛроЯроЪрпН роЪрпЖропрпНрокро╡ро░рпНроХро│рпН роЙроЯро▓ро│ро╡ро┐ро▓рпБроорпН роЙро│рпНро│родрпНродро│ро╡ро┐ро▓рпБроорпН рокрпБродрпНродрпБрогро░рпНро╡рпЛроЯрпБ ро╡ро▓роорпН ро╡ро░рпБроХро┐ро▒ро╛ро░рпНроХро│рпН. рокрпБройрпНройроХрпИропрпЛроЯрпБ роТро░рпБро╡ро░ро┐роЯроорпН рокрпЗроЪрпБроорпНрокрпЛродрпБ роХрпЗроЯрпНрокро╡ро░ро┐ройрпН рооройродрпНродро┐ро▓рпН роЕрокрпНрокрпЗроЪрпНроЪрпБ роОро│ро┐родро┐ро▓рпН рокродро┐ро╡родрпБроЯройрпН роЕро╡ро░рпН роЪрпКро▓рпНро╡родрпИроХрпН роХрпВро░рпНроирпНродрпБ роХрпЗроЯрпНроХрпБроорпН роЖро░рпНро╡родрпНродрпИропрпБроорпН роЕродро┐роХро░ро┐роХрпНроХро┐ро▒родрпБ роОрой роЙро│ро╡ро┐ропро▓рпН роЕро▒ро┐роЮро░рпНроХро│рпН роХрпВро▒рпБроХро┐ройрпНро▒ройро░рпН. роЗро░рпБро╡ро░ро┐роЯрпИропрпЗ роЗро▒рпБроХрпНроХрооро╛рой роЪрпВро┤ро▓рпН роиро┐ро▓ро╡рпБроорпНрокрпЛродрпБ роЙродроЯрпНроЯрпЛро░роорпН роХрпАро┤рпЗропрпЛроЯрпБроорпН рокрпБройрпНройроХрпИ роЕро╡ро░рпНроХро│рпИ роЕроЪрпНроЪрпВро┤ро▓ро┐ро▓ро┐ро░рпБроирпНродрпБ ро╡ро┐роЯрпБро╡ро┐роХрпНроХ роЙродро╡рпБроХро┐ро▒родрпБ.

рокрпБройрпНройроХрпИ роЪро┐ро░ро┐рокрпНрокро╛роХ рооро╛ро▒рпБроорпНрокрпЛродрпБ роЕродрпБ роироороХрпНроХрпБроорпН роироорпНроорпИроЪрпН роЪрпБро▒рпНро▒ро┐ропро┐ро░рпБрокрпНрокрпЛро░рпБроХрпНроХрпБроорпН роороХро┐ро┤рпНроЪрпНроЪро┐ропро╛рой роЪрпВро┤ро▓рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒родрпБ. роТро░рпБро╡ро░рпН роЪро┐ро░ро┐роХрпНроХрпБроорпНрокрпЛродрпБ роЕро╡ро░рпБроЯрпИроп роЙроЯро▓ро┐ро▓рпБро│рпНро│ роиро╛ройрпВро▒рпБроХрпНроХрпБроорпН роорпЗро▒рпНрокроЯрпНроЯ родроЪрпИроиро╛ро░рпНроХро│рпН роЗропроХрпНроХрокрпНрокроЯрпНроЯрпБ роЕро╡ро░рпИрокрпН рокрпБродрпНродрпБрогро░рпНроЪрпНроЪро┐ рокрпЖро▒роЪрпН роЪрпЖропрпНроХро┐ройрпНро▒рой. родро▒рпНрокрпЛродрпБ роорпЗро▓рпИ роиро╛роЯрпБроХро│ро┐ро▓рпБро│рпНро│ роЙроЯро▒рпНрокропро┐ро▒рпНроЪро┐роХрпН роХрпВроЯроЩрпНроХро│ро┐ро▓рпН роороХрпНроХро│рпБроХрпНроХрпБ ро╡ро┤роЩрпНроХрокрпНрокроЯрпБроорпН рокропро┐ро▒рпНроЪро┐роХро│рпБро│рпН роЪро┐ро░ро┐роХрпНроХ ро╡рпИроХрпНроХрпБроорпН рокропро┐ро▒рпНроЪро┐роХро│рпБроорпН роЗроЯроорпНрокрпЖро▒рпНро▒рпБро│рпНро│рой. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЪрпЖропро▒рпНроХрпИропро╛роХ ро╡ро░ро╡ро┤рпИроХрпНроХрокрпНрокроЯрпБроорпН роЪро┐ро░ро┐рокрпНрокрпИро╡ро┐роЯ роЙро│рпНро│ройродрпНродро┐ро▓рпН родрпЛройрпНро▒ро┐ роЗропро▓рпНрокро╛роХ ро╡рпЖро│ро┐рокрпНрокроЯрпБроорпН роЪро┐ро░ро┐рокрпНрокрпЗ ро╡ро▓ро┐роорпИ ро╡ро╛ропрпНроирпНродродрпБ. роЕродрпБ роироорпНроорпИропрпБроорпН рокро┐ро▒ро░рпИропрпБроорпН роЙро▒рпНроЪро╛роХрокрпНрокроЯрпБродрпНродрпБроорпН роороХродрпНродрпБро╡роорпН рокрпЖро▒рпНро▒родрпБ.</textarea>
</div>
<button class="save-btn" onclick="saveAdminChanges()">рооро╛ро▒рпНро▒роЩрпНроХро│рпИроЪрпН роЪрпЗрооро┐</button>
<!-- ========== хп╝хЗ║/хп╝хЕецМЙщТоч╗Д ========== -->
<div class="admin-button-group">
<button class="save-btn export-btn" onclick="exportConfig()">тмЗя╕П роЙро│рпНро│роорпИро╡рпИ роПро▒рпНро▒рпБроородро┐</button>
<button class="save-btn import-btn" onclick="importConfig()">тмЖя╕П роЙро│рпНро│роорпИро╡рпИ роЗро▒роХрпНроХрпБроородро┐</button>
</div>
</div>
<div class="app-container no-print">
<header class="app-header">
<!-- щ╜┐ш╜охЫ╛цаЗ - щХ┐цМЙ 2 чзТц┐Ац┤╗ -->
<div class="gear-icon no-print" id="gear-icon">
<i class="fas fa-cog"></i>
<svg class="progress-ring" width="44" height="44">
<circle class="progress-ring__circle" stroke="#10b981" stroke-width="3" fill="transparent" r="19" cx="22" cy="22"/>
</svg>
</div>
<h1 class="app-title" id="mainTitle">S4G3 родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐</h1>
<div class="copyright-corner" id="copyright-corner">
<i class="fas fa-copyright" style="display: inline-block; line-height: 1;"></i>
<div class="copyright-author-text">Created by Mr Liu</div>
<div class="copyright-tooltip">
<div class="copyright-tooltip-content">
<p>┬й 2026 - Liu Changyu</p>
<p>All Rights Reserved</p>
<p>This software is for internal school<br>assessment use only.</p>
<p>Unauthorized copying, modification,<br>or distribution is prohibited.</p>
</div>
</div>
</div>
</header>
<section class="student-info">
<div class="info-grid">
<div class="input-group">
<label class="input-label"><i class="fas fa-user"></i> рокрпЖропро░рпН</label>
<input type="text" class="input-field" id="name" placeholder="">
</div>
<div class="input-group">
<label class="input-label"><i class="fas fa-users"></i> ро╡роХрпБрокрпНрокрпБ</label>
<input type="text" class="input-field" id="class" placeholder="">
</div>
<div class="input-group">
<label class="input-label"><i class="fas fa-chalkboard-teacher"></i> родрооро┐ро┤ро╛роЪро┐ро░ро┐ропро░рпН</label>
<input type="text" class="input-field" id="teacher" placeholder="">
</div>
</div>
</section>
<div class="main-content">
<section class="section">
<div class="section-title reading-title">
<div class="title-content">
<i class="fas fa-book-reader"></i>
<span>рокроХрпБродро┐ 1: ро╡ро╛ропрпНро╡ро┐роЯрпНроЯрпБ ро╡ро╛роЪро┐родрпНродро▓рпН (10 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</span>
</div>
<button class="delete-marks-btn no-print" id="clearMistakesBtn" title="роЕройрпИродрпНродрпБрокрпН рокро┐ро┤рпИроХрпН роХрпБро▒ро┐роХро│рпИропрпБроорпН роирпАроХрпНроХрпБроХ">
<i class="fas fa-eraser"></i>
</button>
</div>
<div class="reading-layout">
<div class="passage-column">
<div class="passage-container">
<div class="passage-text" id="passageDisplay"></div>
</div>
</div>
<div class="comments-column">
<div class="textarea-group">
<label><i class="fas fa-file-pen"></i>ро╡ро╛роЪро┐рокрпНрокрпБроХрпН роХро░рпБродрпНродрпБя╝Ъ</label>
<div class="text-format-container">
<div class="format-toolbar" id="readingCommentToolbar">
<button class="format-btn" data-action="bold" title="родроЯро┐родрпНрод (Ctrl+B)"><i class="fas fa-bold"></i></button>
<button class="format-btn" data-action="italic" title="роЪро╛ропрпНро╡рпБ (Ctrl+I)"><i class="fas fa-italic"></i></button>
<button class="format-btn" data-action="underline" title="роЕроЯро┐роХрпНроХрпЛроЯрпБ (Ctrl+U)"><i class="fas fa-underline"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="ordered" title="роОрогрпНрогро┐роЯрокрпНрокроЯрпНроЯ рокроЯрпНроЯро┐ропро▓рпН"><i class="fas fa-list-ol"></i></button>
<button class="format-btn" data-action="unordered" title="рокрпБро▓рпНро▓роЯрпНроЯрпБроХро│рпН"><i class="fas fa-list-ul"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="indent-increase" title="роЙро│рпНродро│рпНро│ро▓рпИ роЕродро┐роХро░ро┐"><i class="fas fa-indent"></i></button>
<button class="format-btn" data-action="indent-decrease" title="роЙро│рпНродро│рпНро│ро▓рпИроХрпН роХрпБро▒рпИ"><i class="fas fa-outdent"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="quick-phrase" title="ро╡ро┐ро░рпИро╡рпБродрпН родрпКроЯро░рпНроХро│рпН"><i class="fas fa-comment"></i></button>
</div>
<div class="editable-content" spellcheck="false" id="readingComment" contenteditable="true" placeholder="рокрпБро│рпНро│ро┐роХро│рпИроХрпН роХрпБро▒ро┐родрпНродрпБ роХро░рпБродрпНродрпБроХро│рпИрокрпН рокродро┐ро╡ро┐роЯрпБроХ"></div>
</div>
</div>
<div class="score-card">
<div class="score-header">
<div><i class="fas fa-edit"></i>ро╡ро╛роЪро┐рокрпНрокрпБрокрпН рокрпБро│рпНро│ро┐</div>
<div class="score-value" id="readingScore" data-initial="true">0</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 1</div>
<div class="score-buttons" data-type="reading" data-level="1">
<div class="score-btn" data-score="10">10</div>
<div class="score-btn" data-score="9">9</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 2</div>
<div class="score-buttons" data-type="reading" data-level="2">
<div class="score-btn" data-score="8">8</div>
<div class="score-btn" data-score="7">7</div>
<div class="score-btn" data-score="6">6</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 3</div>
<div class="score-buttons" data-type="reading" data-level="3">
<div class="score-btn" data-score="5">5</div>
<div class="score-btn" data-score="4">4</div>
<div class="score-btn" data-score="3">3</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 4</div>
<div class="score-buttons" data-type="reading" data-level="4">
<div class="score-btn" data-score="2">2</div>
<div class="score-btn" data-score="1">1</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="section">
<h2 class="section-title"><i class="fas fa-comments"></i>рокроХрпБродро┐ 2: роЙро░рпИропро╛роЯро▓рпН (40 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</h2>
<div class="scoring-grid">
<div class="score-card">
<div class="score-header">
<div><i class="fas fa-edit"></i>роХро░рпБродрпНродрпБро░рпИродрпНродро▓рпБроорпН роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ропрпБроорпН</div>
<div class="score-value" id="contentScore" data-initial="true">0</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 1</div>
<div class="score-buttons" data-type="content" data-level="1">
<div class="score-btn" data-score="20">20</div>
<div class="score-btn" data-score="19">19</div>
<div class="score-btn" data-score="18">18</div>
<div class="score-btn" data-score="17">17</div>
<div class="score-btn" data-score="16">16</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 2</div>
<div class="score-buttons" data-type="content" data-level="2">
<div class="score-btn" data-score="15">15</div>
<div class="score-btn" data-score="14">14</div>
<div class="score-btn" data-score="13">13</div>
<div class="score-btn" data-score="12">12</div>
<div class="score-btn" data-score="11">11</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 3</div>
<div class="score-buttons" data-type="content" data-level="3">
<div class="score-btn" data-score="10">10</div>
<div class="score-btn" data-score="9">9</div>
<div class="score-btn" data-score="8">8</div>
<div class="score-btn" data-score="7">7</div>
<div class="score-btn" data-score="6">6</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 4</div>
<div class="score-buttons" data-type="content" data-level="4">
<div class="score-btn" data-score="5">5</div>
<div class="score-btn" data-score="4">4</div>
<div class="score-btn" data-score="3">3</div>
<div class="score-btn" data-score="2">2</div>
<div class="score-btn" data-score="1">1</div>
</div>
</div>
</div>
<div class="score-card">
<div class="score-header">
<div><i class="fas fa-edit"></i>роЪро░ро│роорпБроорпН роорпКро┤ро┐рокрпН рокропройрпНрокро╛роЯрпБроорпН</div>
<div class="score-value" id="expressionScore" data-initial="true">0</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 1</div>
<div class="score-buttons" data-type="expression" data-level="1">
<div class="score-btn" data-score="20">20</div>
<div class="score-btn" data-score="19">19</div>
<div class="score-btn" data-score="18">18</div>
<div class="score-btn" data-score="17">17</div>
<div class="score-btn" data-score="16">16</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 2</div>
<div class="score-buttons" data-type="expression" data-level="2">
<div class="score-btn" data-score="15">15</div>
<div class="score-btn" data-score="14">14</div>
<div class="score-btn" data-score="13">13</div>
<div class="score-btn" data-score="12">12</div>
<div class="score-btn" data-score="11">11</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 3</div>
<div class="score-buttons" data-type="expression" data-level="3">
<div class="score-btn" data-score="10">10</div>
<div class="score-btn" data-score="9">9</div>
<div class="score-btn" data-score="8">8</div>
<div class="score-btn" data-score="7">7</div>
<div class="score-btn" data-score="6">6</div>
</div>
</div>
<div class="score-level">
<div class="level-label">роиро┐ро▓рпИ 4</div>
<div class="score-buttons" data-type="expression" data-level="4">
<div class="score-btn" data-score="5">5</div>
<div class="score-btn" data-score="4">4</div>
<div class="score-btn" data-score="3">3</div>
<div class="score-btn" data-score="2">2</div>
<div class="score-btn" data-score="1">1</div>
</div>
</div>
</div>
</div>
</section>
<section class="section">
<h2 class="section-title" style="font-family: var(--font-ui); font-weight: 400; font-size: 1.1rem;">
<i class="fas fa-file-pen"></i>роЙро░рпИропро╛роЯро▓рпБроХрпНроХро╛рой роХро░рпБродрпНродрпБ
</h2>
<div class="question" id="question1Container">
<p id="question1Text">1. роТро│ро┐роХрпНроХро╛роЯрпНроЪро┐ропро┐ро▓рпН роЪро┐ро▓ роироЯро╡роЯро┐роХрпНроХрпИроХро│рпН роЗроЯроорпН рокрпЖро▒рпНро▒ро┐ро░рпБроирпНродрой. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│ро┐ро▓рпН рокроЩрпНроХрпБрокрпЖро▒ роирпА ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒ро╛ропро╛? роПройрпН?</p>
<div class="textarea-group">
<div class="text-format-container">
<div class="format-toolbar" id="q1Toolbar">
<button class="format-btn" data-action="bold" title="родроЯро┐родрпНрод (Ctrl+B)"><i class="fas fa-bold"></i></button>
<button class="format-btn" data-action="italic" title="роЪро╛ропрпНро╡рпБ (Ctrl+I)"><i class="fas fa-italic"></i></button>
<button class="format-btn" data-action="underline" title="роЕроЯро┐роХрпНроХрпЛроЯрпБ (Ctrl+U)"><i class="fas fa-underline"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="ordered" title="роОрогрпНрогро┐роЯрокрпНрокроЯрпНроЯ рокроЯрпНроЯро┐ропро▓рпН"><i class="fas fa-list-ol"></i></button>
<button class="format-btn" data-action="unordered" title="рокрпБро▓рпНро▓роЯрпНроЯрпБроХро│рпН"><i class="fas fa-list-ul"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="indent-increase" title="роЙро│рпНродро│рпНро│ро▓рпИ роЕродро┐роХро░ро┐"><i class="fas fa-indent"></i></button>
<button class="format-btn" data-action="indent-decrease" title="роЙро│рпНродро│рпНро│ро▓рпИроХрпН роХрпБро▒рпИ"><i class="fas fa-outdent"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="quick-phrase" title="ро╡ро┐ро░рпИро╡рпБродрпН родрпКроЯро░рпНроХро│рпН"><i class="fas fa-comment"></i></button>
</div>
<div class="editable-content" spellcheck="false" id="q1" contenteditable="true" placeholder="рокрпБро│рпНро│ро┐роХро│рпИроХрпН роХрпБро▒ро┐родрпНродрпБ роХро░рпБродрпНродрпБроХро│рпИрокрпН рокродро┐ро╡ро┐роЯрпБроХ"></div>
</div>
</div>
</div>
<div class="question" id="question2Container">
<p id="question2Text">2. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│ро┐ро▓рпН роЕродро┐роХрооро╛рой рооро╛рогро╡ро░рпНроХро│рпН рокроЩрпНроХрпЗро▒рпНроХ роОро╡рпНро╡ро╛ро▒рпБ рокро│рпНро│ро┐роХро│рпН роЕро╡ро░рпНроХро│рпИ роКроХрпНроХрпБро╡ро┐роХрпНроХро▓ро╛роорпН?</p>
<div class="textarea-group">
<div class="text-format-container">
<div class="format-toolbar" id="q2Toolbar">
<button class="format-btn" data-action="bold" title="родроЯро┐родрпНрод (Ctrl+B)"><i class="fas fa-bold"></i></button>
<button class="format-btn" data-action="italic" title="роЪро╛ропрпНро╡рпБ (Ctrl+I)"><i class="fas fa-italic"></i></button>
<button class="format-btn" data-action="underline" title="роЕроЯро┐роХрпНроХрпЛроЯрпБ (Ctrl+U)"><i class="fas fa-underline"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="ordered" title="роОрогрпНрогро┐роЯрокрпНрокроЯрпНроЯ рокроЯрпНроЯро┐ропро▓рпН"><i class="fas fa-list-ol"></i></button>
<button class="format-btn" data-action="unordered" title="рокрпБро▓рпНро▓роЯрпНроЯрпБроХро│рпН"><i class="fas fa-list-ul"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="indent-increase" title="роЙро│рпНродро│рпНро│ро▓рпИ роЕродро┐роХро░ро┐"><i class="fas fa-indent"></i></button>
<button class="format-btn" data-action="indent-decrease" title="роЙро│рпНродро│рпНро│ро▓рпИроХрпН роХрпБро▒рпИ"><i class="fas fa-outdent"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="quick-phrase" title="ро╡ро┐ро░рпИро╡рпБродрпН родрпКроЯро░рпНроХро│рпН"><i class="fas fa-comment"></i></button>
</div>
<div class="editable-content" spellcheck="false" id="q2" contenteditable="true" placeholder="рокрпБро│рпНро│ро┐роХро│рпИроХрпН роХрпБро▒ро┐родрпНродрпБ роХро░рпБродрпНродрпБроХро│рпИрокрпН рокродро┐ро╡ро┐роЯрпБроХ"></div>
</div>
</div>
</div>
<div class="question" id="question3Container">
<p id="question3Text">3. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│рпН рооро╛рогро╡ро░рпНроХро│ро┐ройрпН рокрогрпНрокрпБроиро▓ройрпНроХро│рпИ ро╡ро│ро░рпНроХрпНроХро┐ройрпНро▒рой. роирпА роЗроХрпНроХро░рпБродрпНродро┐ройрпИ роПро▒рпНро▒рпБроХрпНроХрпКро│рпНроХро┐ро▒ро╛ропро╛? роПройрпН?</p>
<div class="textarea-group">
<div class="text-format-container">
<div class="format-toolbar" id="q3Toolbar">
<button class="format-btn" data-action="bold" title="родроЯро┐родрпНрод (Ctrl+B)"><i class="fas fa-bold"></i></button>
<button class="format-btn" data-action="italic" title="роЪро╛ропрпНро╡рпБ (Ctrl+I)"><i class="fas fa-italic"></i></button>
<button class="format-btn" data-action="underline" title="роЕроЯро┐роХрпНроХрпЛроЯрпБ (Ctrl+U)"><i class="fas fa-underline"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="ordered" title="роОрогрпНрогро┐роЯрокрпНрокроЯрпНроЯ рокроЯрпНроЯро┐ропро▓рпН"><i class="fas fa-list-ol"></i></button>
<button class="format-btn" data-action="unordered" title="рокрпБро▓рпНро▓роЯрпНроЯрпБроХро│рпН"><i class="fas fa-list-ul"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="indent-increase" title="роЙро│рпНродро│рпНро│ро▓рпИ роЕродро┐роХро░ро┐"><i class="fas fa-indent"></i></button>
<button class="format-btn" data-action="indent-decrease" title="роЙро│рпНродро│рпНро│ро▓рпИроХрпН роХрпБро▒рпИ"><i class="fas fa-outdent"></i></button>
<span class="toolbar-divider"></span>
<button class="format-btn" data-action="quick-phrase" title="ро╡ро┐ро░рпИро╡рпБродрпН родрпКроЯро░рпНроХро│рпН"><i class="fas fa-comment"></i></button>
</div>
<div class="editable-content" spellcheck="false" id="q3" contenteditable="true" placeholder="рокрпБро│рпНро│ро┐роХро│рпИроХрпН роХрпБро▒ро┐родрпНродрпБ роХро░рпБродрпНродрпБроХро│рпИрокрпН рокродро┐ро╡ро┐роЯрпБроХ"></div>
</div>
</div>
</div>
</section>
<div class="action-bar no-print" id="mainActionBar">
<div class="action-buttons-row">
<button class="action-btn btn-primary" onclick="saveStudent()" id="saveStudentBtn"><i class="fas fa-save"></i>роЪрпЗрооро┐</button>
<button class="action-btn btn-revision" onclick="showRevisionStudentList()" id="revisionBtn"><i class="fas fa-pen-to-square"></i>родро┐ро░рпБродрпНродрпБ</button>
<button class="action-btn btn-warning" onclick="generatePDF(true)"><i class="fas fa-print"></i>роорпБро┤рпБ роЕроЪрпНроЪрпБ</button>
<button class="action-btn btn-print-simple" onclick="generatePDF(false)"><i class="fas fa-file"></i>роЪрпБро░рпБроХрпНроХ роЕроЪрпНроЪрпБ</button>
</div>
<div style="margin-top: 10px; font-size: 0.85rem; color: #555; text-align: center;">
ЁЯЦия╕П роЕроЪрпНроЪро┐роЯрпБроорпНрокрпЛродрпБ, роЙро▓ро╛ро╡ро┐ропро┐ройрпН роЕроЪрпНроЪрпБ роЕроорпИрокрпНрокрпБроХро│ро┐ро▓рпН <strong>"родро▓рпИрокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЕроЯро┐роХрпНроХрпБро▒ро┐рокрпНрокрпБ"</strong> роорпБроЯроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпИ роЙро▒рпБродро┐роЪрпЖропрпНропро╡рпБроорпН.
</div>
</div>
<section class="records-section" id="recordsSection">
<h2 class="section-title"><i class="fas fa-chart-column"></i>рооро╛рогро╡ро░рпН роЪрпЖропро▓рпНродро┐ро▒ройрпН рокродро┐ро╡рпБроХро│рпН</h2>
<table class="records-table" id="recordTable">
<thead>
<tr><th>рокрпЖропро░рпН</th><th>ро╡роХрпБрокрпНрокрпБ</th><th>родрооро┐ро┤ро╛роЪро┐ро░ро┐ропро░рпН</th><th>ро╡ро╛роЪро┐рокрпНрокрпБ</th><th>роЙро│рпНро│роЯроХрпНроХроорпН</th><th>роорпКро┤ро┐</th><th>роорпКродрпНродроорпН</th><th>роЪрпЖропро▓рпН</th></tr>
</thead>
<tbody id="recordList"></tbody>
</table>
</section>
<div class="revision-bottom-bar" id="revisionBottomBar">
<div class="revision-buttons">
<button class="action-btn btn-success" onclick="saveRevision()" id="saveRevisionBtn"><i class="fas fa-check-circle"></i>родро┐ро░рпБродрпНродроЩрпНроХро│рпИроЪрпН роЪрпЗрооро┐</button>
<button class="action-btn btn-danger" onclick="cancelRevision()" id="cancelRevisionBtn"><i class="fas fa-times-circle"></i>родро┐ро░рпБродрпНродродрпНродрпИ ро░родрпНродрпБ</button>
</div>
</div>
</div>
</div>
<button class="floating-btn no-print" id="criteria-btn" title="роородро┐рокрпНрокрпАроЯрпНроЯрпБродрпН родро┐роЯрпНроЯродрпНродрпИрокрпН рокро╛ро░рпНроХрпНроХ"><i class="fas fa-book"></i></button>
<div id="rubricModal" class="modal no-print">
<div class="modal-content">
<h3 style="text-align: center; margin-bottom: 20px; font-family: var(--font-display); font-weight: 600;">роородро┐рокрпНрокрпАроЯрпНроЯрпБродрпН родро┐роЯрпНроЯроорпН</h3>
<div id="rubricContent" style="max-height: 70vh; overflow-y: auto;"></div>
</div>
</div>
<script>
// ========== хПШщЗПхг░цШО ==========
let PASSAGE = `роТро░рпБро╡ро░родрпБ рокрпБройрпНройроХрпИ рокро┐ро▒ро░рпИроХрпН роХро╡ро░рпНроирпНродрпБ роЗро┤рпБроХрпНроХроХрпНроХрпВроЯро┐роп роЖро▒рпНро▒ро▓рпН рооро┐роХрпНроХродрпБ. родроорпН роорпБроХродрпНродро┐ро▓рпН роОрокрпНрокрпЛродрпБроорпН рокрпБройрпНройроХрпИропрпИроХрпН роХрпАро┤рпЗропрпЛроЯроЪрпН роЪрпЖропрпНрокро╡ро░рпНроХро│рпН роЙроЯро▓ро│ро╡ро┐ро▓рпБроорпН роЙро│рпНро│родрпНродро│ро╡ро┐ро▓рпБроорпН рокрпБродрпНродрпБрогро░рпНро╡рпЛроЯрпБ ро╡ро▓роорпН ро╡ро░рпБроХро┐ро▒ро╛ро░рпНроХро│рпН. рокрпБройрпНройроХрпИропрпЛроЯрпБ роТро░рпБро╡ро░ро┐роЯроорпН рокрпЗроЪрпБроорпНрокрпЛродрпБ роХрпЗроЯрпНрокро╡ро░ро┐ройрпН рооройродрпНродро┐ро▓рпН роЕрокрпНрокрпЗроЪрпНроЪрпБ роОро│ро┐родро┐ро▓рпН рокродро┐ро╡родрпБроЯройрпН роЕро╡ро░рпН роЪрпКро▓рпНро╡родрпИроХрпН роХрпВро░рпНроирпНродрпБ роХрпЗроЯрпНроХрпБроорпН роЖро░рпНро╡родрпНродрпИропрпБроорпН роЕродро┐роХро░ро┐роХрпНроХро┐ро▒родрпБ роОрой роЙро│ро╡ро┐ропро▓рпН роЕро▒ро┐роЮро░рпНроХро│рпН роХрпВро▒рпБроХро┐ройрпНро▒ройро░рпН. роЗро░рпБро╡ро░ро┐роЯрпИропрпЗ роЗро▒рпБроХрпНроХрооро╛рой роЪрпВро┤ро▓рпН роиро┐ро▓ро╡рпБроорпНрокрпЛродрпБ роЙродроЯрпНроЯрпЛро░роорпН роХрпАро┤рпЗропрпЛроЯрпБроорпН рокрпБройрпНройроХрпИ роЕро╡ро░рпНроХро│рпИ роЕроЪрпНроЪрпВро┤ро▓ро┐ро▓ро┐ро░рпБроирпНродрпБ ро╡ро┐роЯрпБро╡ро┐роХрпНроХ роЙродро╡рпБроХро┐ро▒родрпБ.

рокрпБройрпНройроХрпИ роЪро┐ро░ро┐рокрпНрокро╛роХ рооро╛ро▒рпБроорпНрокрпЛродрпБ роЕродрпБ роироороХрпНроХрпБроорпН роироорпНроорпИроЪрпН роЪрпБро▒рпНро▒ро┐ропро┐ро░рпБрокрпНрокрпЛро░рпБроХрпНроХрпБроорпН роороХро┐ро┤рпНроЪрпНроЪро┐ропро╛рой роЪрпВро┤ро▓рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒родрпБ. роТро░рпБро╡ро░рпН роЪро┐ро░ро┐роХрпНроХрпБроорпНрокрпЛродрпБ роЕро╡ро░рпБроЯрпИроп роЙроЯро▓ро┐ро▓рпБро│рпНро│ роиро╛ройрпВро▒рпБроХрпНроХрпБроорпН роорпЗро▒рпНрокроЯрпНроЯ родроЪрпИроиро╛ро░рпНроХро│рпН роЗропроХрпНроХрокрпНрокроЯрпНроЯрпБ роЕро╡ро░рпИрокрпН рокрпБродрпНродрпБрогро░рпНроЪрпНроЪро┐ рокрпЖро▒роЪрпН роЪрпЖропрпНроХро┐ройрпНро▒рой. родро▒рпНрокрпЛродрпБ роорпЗро▓рпИ роиро╛роЯрпБроХро│ро┐ро▓рпБро│рпНро│ роЙроЯро▒рпНрокропро┐ро▒рпНроЪро┐роХрпН роХрпВроЯроЩрпНроХро│ро┐ро▓рпН роороХрпНроХро│рпБроХрпНроХрпБ ро╡ро┤роЩрпНроХрокрпНрокроЯрпБроорпН рокропро┐ро▒рпНроЪро┐роХро│рпБро│рпН роЪро┐ро░ро┐роХрпНроХ ро╡рпИроХрпНроХрпБроорпН рокропро┐ро▒рпНроЪро┐роХро│рпБроорпН роЗроЯроорпНрокрпЖро▒рпНро▒рпБро│рпНро│рой. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЪрпЖропро▒рпНроХрпИропро╛роХ ро╡ро░ро╡ро┤рпИроХрпНроХрокрпНрокроЯрпБроорпН роЪро┐ро░ро┐рокрпНрокрпИро╡ро┐роЯ роЙро│рпНро│ройродрпНродро┐ро▓рпН родрпЛройрпНро▒ро┐ роЗропро▓рпНрокро╛роХ ро╡рпЖро│ро┐рокрпНрокроЯрпБроорпН роЪро┐ро░ро┐рокрпНрокрпЗ ро╡ро▓ро┐роорпИ ро╡ро╛ропрпНроирпНродродрпБ. роЕродрпБ роироорпНроорпИропрпБроорпН рокро┐ро▒ро░рпИропрпБроорпН роЙро▒рпНроЪро╛роХрокрпНрокроЯрпБродрпНродрпБроорпН роороХродрпНродрпБро╡роорпН рокрпЖро▒рпНро▒родрпБ.`;
let CONVERSATION_PROMPTS = [
"1. роТро│ро┐роХрпНроХро╛роЯрпНроЪро┐ропро┐ро▓рпН роЪро┐ро▓ роироЯро╡роЯро┐роХрпНроХрпИроХро│рпН роЗроЯроорпН рокрпЖро▒рпНро▒ро┐ро░рпБроирпНродрой. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│ро┐ро▓рпН рокроЩрпНроХрпБрокрпЖро▒ роирпА ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒ро╛ропро╛? роПройрпН?",
"2. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│ро┐ро▓рпН роЕродро┐роХрооро╛рой рооро╛рогро╡ро░рпНроХро│рпН рокроЩрпНроХрпЗро▒рпНроХ роОро╡рпНро╡ро╛ро▒рпБ рокро│рпНро│ро┐роХро│рпН роЕро╡ро░рпНроХро│рпИ роКроХрпНроХрпБро╡ро┐роХрпНроХро▓ро╛роорпН?",
"3. роЗродрпНродроХрпИроп роироЯро╡роЯро┐роХрпНроХрпИроХро│рпН рооро╛рогро╡ро░рпНроХро│ро┐ройрпН рокрогрпНрокрпБроиро▓ройрпНроХро│рпИ ро╡ро│ро░рпНроХрпНроХро┐ройрпНро▒рой. роирпА роЗроХрпНроХро░рпБродрпНродро┐ройрпИ роПро▒рпНро▒рпБроХрпНроХрпКро│рпНроХро┐ро▒ро╛ропро╛? роПройрпН?"
];
let scores = { reading: 0, content: 0, expression: 0 };
let isSelecting = false;
let selectionStart = null;
let selectionEnd = null;
let isRevisionMode = false;
let currentEditIndex = null;
let originalData = {};
let contextMenu = null;
let activeTextarea = null;
let quickPhraseMenu = null;
let activeEditable = null;
let lastSavedRange = null;
// ========== х╜УхЙНх╣┤ч║з/ц║Рц╡БхПШщЗП ==========
let currentGrade = 'S4_G3_TL';
// ========== чобчРЖщЭвцЭ┐щА╗ш╛С ==========
let pressVisualTimer;
let pressActivateTimer;
let isLongPressing = false;
const gearIcon = document.getElementById('gear-icon');
const adminPanel = document.getElementById('adminPanel');
const LONG_PRESS_TIME = 2000;
const VISUAL_DELAY = 100;
adminPanel.classList.remove('show');
function startPress(e) {
e.preventDefault();
isLongPressing = false;
pressVisualTimer = setTimeout(() => {
gearIcon.classList.add('pressing');
isLongPressing = true;
}, VISUAL_DELAY);
pressActivateTimer = setTimeout(() => {
if (isLongPressing) {
gearIcon.classList.remove('pressing');
gearIcon.classList.add('activated');
toggleAdminPanel();
setTimeout(() => gearIcon.classList.remove('activated'), 500);
}
}, LONG_PRESS_TIME);
}
function cancelPress(e) {
if (e) e.preventDefault();
clearTimeout(pressVisualTimer);
clearTimeout(pressActivateTimer);
gearIcon.classList.remove('pressing');
isLongPressing = false;
}
function closeAdminPanel() {
adminPanel.classList.remove('show');
}
function toggleAdminPanel() {
adminPanel.classList.toggle('show');
if (adminPanel.classList.contains('show')) {
document.getElementById('input-conversation-prompts').value = CONVERSATION_PROMPTS.join('\n');
document.getElementById('input-reading-passage').value = PASSAGE;
const selectEl = document.getElementById('gradeStreamSelect');
if (selectEl) selectEl.value = currentGrade;
}
}
function updatePageTitle() {
const titleMap = {
'S4_G3_TL': 'S4G3 родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐',
'S3_G3_TL': 'S3G3 родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐',
'S2_G3_TL': 'S2G3 родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐',
'S1_G3_TL': 'S1G3 родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐'
};
const titleEl = document.getElementById('mainTitle');
if (titleEl) {
titleEl.textContent = titleMap[currentGrade] || 'родрооро┐ро┤рпН ро╡ро╛ропрпНроорпКро┤ро┐ роородро┐рокрпНрокрпАроЯрпНроЯрпБроХрпН роХро░рпБро╡ро┐';
}
}
function saveAdminChanges() {
const selectedGrade = document.getElementById('gradeStreamSelect').value;
currentGrade = selectedGrade;
localStorage.setItem(currentGrade + '_current', 'true');
const newPrompts = document.getElementById('input-conversation-prompts').value.split('\n').filter(p => p.trim() !== '');
const newPassage = document.getElementById('input-reading-passage').value;
CONVERSATION_PROMPTS = newPrompts;
PASSAGE = newPassage;
localStorage.setItem(currentGrade + '_prompts', JSON.stringify(CONVERSATION_PROMPTS));
localStorage.setItem(currentGrade + '_passage', PASSAGE);
updatePageTitle();
initPassage();
initConversationQuestionsText();
formatPassageNumbersSafely();
initEditableAreas();
bindQuickPhraseButtons();
initCopyrightHover();
closeAdminPanel();
alert('тЬУ рооро╛ро▒рпНро▒роЩрпНроХро│рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯрой (родро▒рпНрокрпЛродрпИроп родро░роорпН: ' + currentGrade + ')');
}
function initConversationQuestionsText() {
if (CONVERSATION_PROMPTS.length >= 1) document.getElementById('question1Text').innerText = CONVERSATION_PROMPTS[0];
if (CONVERSATION_PROMPTS.length >= 2) document.getElementById('question2Text').innerText = CONVERSATION_PROMPTS[1];
if (CONVERSATION_PROMPTS.length >= 3) document.getElementById('question3Text').innerText = CONVERSATION_PROMPTS[2];
}
gearIcon.addEventListener('mousedown', startPress);
gearIcon.addEventListener('mouseup', cancelPress);
gearIcon.addEventListener('mouseleave', cancelPress);
gearIcon.addEventListener('touchstart', startPress, { passive: false });
gearIcon.addEventListener('touchend', cancelPress);
gearIcon.addEventListener('touchcancel', cancelPress);
function init() {
const possibleGrades = ['S4_G3_TL', 'S3_G3_TL', 'S2_G3_TL', 'S1_G3_TL'];
let foundGrade = 'S4_G3_TL';
for (let grade of possibleGrades) {
if (localStorage.getItem(grade + '_current') === 'true') {
foundGrade = grade;
break;
}
}
currentGrade = foundGrade;
const savedPrompts = localStorage.getItem(currentGrade + '_prompts');
const savedPassage = localStorage.getItem(currentGrade + '_passage');
if (savedPrompts) CONVERSATION_PROMPTS = JSON.parse(savedPrompts);
if (savedPassage) PASSAGE = savedPassage;
updatePageTitle();
initPassage();
initConversationQuestionsText();
initScoreButtons();
loadRecords();
setupFloatingButton();
initRubricContent();
document.getElementById('rubricModal').style.display = 'none';
document.getElementById('globalCloseBtn').style.display = 'none';
initMistakeMarking();
formatPassageNumbersSafely();
initContextMenu();
initFormatToolbars();
initQuickPhraseMenu();
initEditableAreas();
bindQuickPhraseButtons();
updateScoreDisplay('reading', 0);
updateScoreDisplay('content', 0);
updateScoreDisplay('expression', 0);
setTimeout(() => {
adminPanel.classList.remove('show');
bindQuickPhraseButtons();
}, 300);
}
function initPassage() {
const container = document.getElementById('passageDisplay');
// цМЙхПМцНвшбМчмжхИЖхЙ▓цо╡шР╜я╝Мф┐ЭчХЩцо╡шР╜ч╗УцЮД
const paragraphs = PASSAGE.split(/\n\s*\n/);
let passageHTML = '';
paragraphs.forEach((paragraph, pIndex) => {
const trimmedPara = paragraph.trim();
if (trimmedPara) {
passageHTML += '<p>';
const chars = trimmedPara.split('');
chars.forEach((char, cIndex) => {
passageHTML += `<span class="word" data-index="${pIndex * 10000 + cIndex}">${char}</span>`;
});
passageHTML += '</p>';
}
});
container.innerHTML = passageHTML;
}
function formatPassageNumbersSafely() {
const passageElement = document.getElementById('passageDisplay');
if (!passageElement) return;
const words = passageElement.querySelectorAll('.word');
words.forEach(word => {
const text = word.textContent;
if (/^\d$/.test(text)) {
word.classList.add('number-in-passage');
}
});
}
function initMistakeMarking() {
const container = document.getElementById('passageDisplay');
const clearMistakesBtn = document.getElementById('clearMistakesBtn');
container.addEventListener('click', (e) => {
if (e.target.classList.contains('word')) {
e.target.classList.add('mistake');
}
});
container.addEventListener('mousedown', (e) => {
if (e.target.classList.contains('word')) {
isSelecting = true;
clearHighlights();
selectionStart = parseInt(e.target.dataset.index);
selectionEnd = selectionStart;
e.target.classList.add('highlighted');
e.preventDefault();
}
});
container.addEventListener('mousemove', (e) => {
if (isSelecting && e.target.classList.contains('word')) {
const currentIndex = parseInt(e.target.dataset.index);
if (currentIndex !== selectionEnd) {
clearHighlights();
selectionEnd = currentIndex;
highlightRange(selectionStart, selectionEnd);
}
}
});
document.addEventListener('mouseup', () => {
if (isSelecting && selectionStart !== null && selectionEnd !== null) {
const start = Math.min(selectionStart, selectionEnd);
const end = Math.max(selectionStart, selectionEnd);
for (let i = start; i <= end; i++) {
const word = document.querySelector(`.word[data-index="${i}"]`);
if (word) {
word.classList.add('mistake');
}
}
clearHighlights();
selectionStart = null;
selectionEnd = null;
}
isSelecting = false;
});
clearMistakesBtn.addEventListener('click', () => {
document.querySelectorAll('.word.mistake').forEach(word => {
word.classList.remove('mistake');
});
});
}
function clearHighlights() {
document.querySelectorAll('.word.highlighted').forEach(word => {
word.classList.remove('highlighted');
});
}
function highlightRange(start, end) {
const min = Math.min(start, end);
const max = Math.max(start, end);
for (let i = min; i <= max; i++) {
const word = document.querySelector(`.word[data-index="${i}"]`);
if (word) {
word.classList.add('highlighted');
}
}
}
function initScoreButtons() {
document.querySelectorAll('.score-btn').forEach(btn => {
btn.addEventListener('click', function() {
const scoreButtons = this.closest('.score-buttons');
const type = scoreButtons.dataset.type;
const score = parseInt(this.dataset.score);
document.querySelectorAll(`.score-buttons[data-type="${type}"] .score-btn`).forEach(button => {
button.classList.remove('selected');
});
this.classList.add('selected');
scores[type] = score;
updateScoreDisplay(type, score);
});
});
}
function updateScoreDisplay(type, score) {
const scoreElement = document.getElementById(`${type}Score`);
if (scoreElement) {
scoreElement.textContent = score;
scoreElement.removeAttribute('data-initial');
}
}
function setupFloatingButton() {
const floatingBtn = document.getElementById('criteria-btn');
floatingBtn.addEventListener('click', showRubric);
}
function showRubric() {
document.getElementById('rubricModal').style.display = 'block';
document.getElementById('globalCloseBtn').style.display = 'block';
}
function closeRubric() {
document.getElementById('rubricModal').style.display = 'none';
document.getElementById('globalCloseBtn').style.display = 'none';
}
function initRubricContent() {
const rubricContent = document.getElementById('rubricContent');
rubricContent.innerHTML = `
<h4 style="font-family: var(--font-display); font-weight: 600;">рокроХрпБродро┐ 1: ро╡ро╛ропрпНро╡ро┐роЯрпНроЯрпБ ро╡ро╛роЪро┐родрпНродро▓рпН (10 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</h4>
<table style="width: 100%; border-collapse: collapse; margin: 12px 0; font-family: var(--font-display); font-weight: 400;">
<colgroup><col style="width: 8%;"><col style="width: 12%;"><col style="width: 40%;"><col style="width: 40%;"></colgroup>
<thead><tr><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роиро┐ро▓рпИ</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роородро┐рокрпНрокрпЖрогрпНроХро│рпН</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роЙроЪрпНроЪро░ро┐рокрпНрокрпБроорпН роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпБроорпН</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роЪро░ро│роорпБроорпН роУроЪрпИроиропроорпБроорпН</th></tr></thead>
<tbody>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">9-10</td><td style="border: 1px solid #000; padding: 8px;">тАв родрпЖро│ро┐ро╡ро╛рой роЙроЪрпНроЪро░ро┐рокрпНрокрпБ<br>тАв родрпЖро│ро┐ро╡ро╛рой роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</td><td style="border: 1px solid #000; padding: 8px;">тАв роЪрпАро░ро╛рой роЪро░ро│роорпН<br>тАв рокрпКро░рпБродрпНродрооро╛рой роХрпБро░ро▓рпН роПро▒рпНро▒ роЗро▒роХрпНроХроорпН</td></tr>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">2</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">6-8</td><td style="border: 1px solid #000; padding: 8px;">тАв роЪро┐ро▓ рокро┐ро┤рпИроХро│рпИ роороЯрпНроЯрпБроорпН роХрпКрогрпНроЯ роЙроЪрпНроЪро░ро┐рокрпНрокрпБ<br>тАв рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН родрпЖро│ро┐ро╡ро╛рой роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</td><td style="border: 1px solid #000; padding: 8px;">тАв рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН роЪрпАро░ро╛рой роЪро░ро│роорпН<br>тАв рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН рокрпКро░рпБродрпНродрооро╛рой роХрпБро░ро▓рпН роПро▒рпНро▒ роЗро▒роХрпНроХроорпН</td></tr>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">3</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">3-5</td><td style="border: 1px solid #000; padding: 8px;">тАв роОро│ро┐родро┐ро▓рпН роЕро▒ро┐ропроХрпН роХрпВроЯро┐роп рокро▓ рокро┐ро┤рпИроХро│рпИроХрпН роХрпКрогрпНроЯ роЙроЪрпНроЪро░ро┐рокрпНрокрпБ<br>тАв роУро░ро│ро╡рпБ родрпЖро│ро┐ро╡ро╛рой роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</td><td style="border: 1px solid #000; padding: 8px;">тАв роУро░ро│ро╡рпБ роЪро░ро│роорпН<br>тАв роУро░ро│ро╡рпБ рокрпКро░рпБродрпНродрооро╛рой роХрпБро░ро▓рпН роПро▒рпНро▒ роЗро▒роХрпНроХроорпН</td></tr>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">4</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">1-2</td><td style="border: 1px solid #000; padding: 8px;">тАв родрпЖро│ро┐ро╡ро┐ро▓рпНро▓ро╛род роЙроЪрпНроЪро░ро┐рокрпНрокрпБ<br>тАв родрпЖро│ро┐ро╡ро┐ро▓рпНро▓ро╛род роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</td><td style="border: 1px solid #000; padding: 8px;">тАв роЪро░ро│рооро▒рпНро▒ ро╡ро╛роЪро┐рокрпНрокрпБ<br>тАв роХро┐роЯрпНроЯродрпНродроЯрпНроЯ родройро┐родрпНродройро┐роЪрпН роЪрпКро▓рпНро▓ро╛роХ ро╡ро╛роЪро┐родрпНродро▓рпН</td></tr>
</tbody>
</table>
<h4 style="font-family: var(--font-display); font-weight: 600; margin-top: 20px;">рокроХрпБродро┐ 2: роЙро░рпИропро╛роЯро▓рпН (40 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</h4>
<table style="width: 100%; border-collapse: collapse; margin: 12px 0; font-family: var(--font-display); font-weight: 400;">
<colgroup><col style="width: 8%;"><col style="width: 12%;"><col style="width: 35%;"><col style="width: 12%;"><col style="width: 33%;"></colgroup>
<thead><tr><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роиро┐ро▓рпИ</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роородро┐рокрпНрокрпЖрогрпНроХро│рпН</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роХро░рпБродрпНродрпБро░рпИродрпНродро▓рпБроорпН роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ропрпБроорпН (20 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роородро┐рокрпНрокрпЖрогрпНроХро│рпН</th><th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: 600;">роЪро░ро│роорпБроорпН роорпКро┤ро┐рокрпН рокропройрпНрокро╛роЯрпБроорпН (20 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</th></tr></thead>
<tbody>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">16-20</td><td style="border: 1px solid #000; padding: 8px;">тАв родро▓рпИрокрпНрокрпБроХрпНроХрпБ роПро▒рпНро▒ рокрпКро░рпБроирпНродрооро╛рой роХро░рпБродрпНродрпБроХро│рпИроХрпН роХрпВро▒рпБродро▓рпН<br>тАв роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ родрпЖро│ро┐ро╡ро╛роХро╡рпБроорпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХро╡рпБроорпН роЗро░рпБродрпНродро▓рпН<br>тАв рокрпКро░рпБроирпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроЯройрпН роХро░рпБродрпНродрпБроХро│рпИ ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒рпБродро▓рпН<br>тАв роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНродрпБродро▓рпН</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">16-20</td><td style="border: 1px solid #000; padding: 8px;">тАв роЪро░ро│рооро╛роХ роЙро░рпИропро╛роЯрпБродро▓рпН<br>тАв рокрпКро░рпБроирпНродрооро╛рой роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</td></tr>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">2</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">11-15</td><td style="border: 1px solid #000; padding: 8px;">тАв рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН родро▓рпИрокрпНрокрпБроХрпНроХрпБ роПро▒рпНро▒ рокрпКро░рпБроирпНродрооро╛рой роХро░рпБродрпНродрпБроХро│ро╛роХроХрпН роХрпВро▒рпБродро▓рпН<br>тАв роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН родрпЖро│ро┐ро╡ро╛роХро╡рпБроорпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХро╡рпБроорпН роЗро░рпБродрпНродро▓рпН<br>тАв рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой роХро░рпБродрпНродрпБроХро│рпИрокрпН рокрпКро░рпБроирпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроЯройрпН ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒рпБродро▓рпН<br>тАв рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой ро╡рпЗро│рпИроХро│ро┐ро▓рпН роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНродрпБродро▓рпН</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">11-15</td><td style="border: 1px solid #000; padding: 8px;">тАв роУро░ро│ро╡рпБ роЪро░ро│рооро╛роХ роЙро░рпИропро╛роЯрпБродро▓рпН<br>тАв роУро░ро│ро╡рпБ рокрпКро░рпБроирпНродрооро╛рой роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН роОро│ро┐роп родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</td></tr>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">3</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">6-10</td><td style="border: 1px solid #000; padding: 8px;">тАв роУро░ро│ро╡рпБ родро▓рпИрокрпНрокрпБроХрпНроХрпБ роПро▒рпНро▒ рокрпКро░рпБроирпНродрооро╛рой роХро░рпБродрпНродрпБроХро│ро╛роХроХрпН роХрпВро▒рпБродро▓рпН<br>тАв роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ роУро░ро│ро╡рпБ родрпЖро│ро┐ро╡ро╛роХро╡рпБроорпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХро╡рпБроорпН роЗро░рпБродрпНродро▓рпН<br>тАв роЪро┐ро▓ роХро░рпБродрпНродрпБроХро│рпИрокрпН рокрпКро░рпБроирпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроЯройрпН ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒рпБродро▓рпН<br>тАв роЪро┐ро▓ ро╡рпЗро│рпИроХро│ро┐ро▓рпН роороЯрпНроЯрпБроорпЗ роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНродрпБродро▓рпН</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">6-10</td><td style="border: 1px solid #000; padding: 8px;">тАв родропроХрпНроХродрпНродрпБроЯройрпН роЙро░рпИропро╛роЯрпБродро▓рпН<br>тАв роЪро┐ро▒ро┐родрпБ рокрпКро░рпБроирпНродрооро▒рпНро▒ роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН роОро│ро┐роп родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</td></tr>
<tr><td style="border: 1px solid #000; padding: 8px; text-align: center;">4</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">1-5</td><td style="border: 1px solid #000; padding: 8px;">тАв рооро┐роХроХрпН роХрпБро▒рпИроирпНрод роХро░рпБродрпНродрпБроХро│рпИроХрпН роХрпВро▒рпБродро▓рпН<br>тАв роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ роХрпБро▒рпИроирпНрод роЕро│ро╡ро┐ро▓рпН роЗро░рпБродрпНродро▓рпН<br>тАв рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой роХро░рпБродрпНродрпБроХро│рпИ ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒ роЗропро▓ро╛родро┐ро░рпБродрпНродро▓рпН<br>тАв роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНрод роЗропро▓ро╛родро┐ро░рпБродрпНродро▓рпН</td><td style="border: 1px solid #000; padding: 8px; text-align: center;">1-5</td><td style="border: 1px solid #000; padding: 8px;">тАв роЕродро┐роХродрпН родропроХрпНроХродрпНродрпБроЯройрпН роЙро░рпИропро╛роЯрпБродро▓рпН<br>тАв рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН рокрпКро░рпБроирпНродрооро▒рпНро▒ роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН роОро│ро┐роп родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</td></tr>
</tbody>
</table>
`;
}
function initEditableAreas() {
const editableIds = ['readingComment', 'q1', 'q2', 'q3'];
editableIds.forEach(id => {
const editable = document.getElementById(id);
if (editable) {
editable.setAttribute('spellcheck', 'false');
editable.addEventListener('keydown', function(e) {
if (e.key === 'Tab' && !e.ctrlKey && !e.altKey) {
e.preventDefault();
if (e.shiftKey) {
document.execCommand('outdent', false, null);
} else {
document.execCommand('indent', false, null);
}
}
if (e.ctrlKey && !e.shiftKey && !e.altKey) {
if (e.key === 'b' || e.key === 'B') {
e.preventDefault();
document.execCommand('bold', false, null);
updateToolbarButtons(editable);
}
if (e.key === 'i' || e.key === 'I') {
e.preventDefault();
document.execCommand('italic', false, null);
updateToolbarButtons(editable);
}
if (e.key === 'u' || e.key === 'U') {
e.preventDefault();
document.execCommand('underline', false, null);
updateToolbarButtons(editable);
}
}
});
editable.addEventListener('click', function() {
activeEditable = editable;
updateToolbarButtons(editable);
});
editable.addEventListener('keyup', function() {
activeEditable = editable;
updateToolbarButtons(editable);
});
editable.addEventListener('focus', function() {
activeEditable = editable;
updateToolbarButtons(editable);
});
editable.addEventListener('paste', function(e) {
e.preventDefault();
const text = (e.clipboardData || window.clipboardData).getData('text');
document.execCommand('insertText', false, text);
});
}
});
}
function updateToolbarButtons(editable) {
if (!editable) return;
const toolbar = editable.closest('.text-format-container').querySelector('.format-toolbar');
if (!toolbar) return;
const isBold = document.queryCommandState('bold');
const isItalic = document.queryCommandState('italic');
const isUnderline = document.queryCommandState('underline');
const boldBtn = toolbar.querySelector('[data-action="bold"]');
const italicBtn = toolbar.querySelector('[data-action="italic"]');
const underlineBtn = toolbar.querySelector('[data-action="underline"]');
if (boldBtn) boldBtn.classList.toggle('active', isBold);
if (italicBtn) italicBtn.classList.toggle('active', isItalic);
if (underlineBtn) underlineBtn.classList.toggle('active', isUnderline);
}
function initFormatToolbars() {
const textareas = [
{ id: 'readingComment', toolbarId: 'readingCommentToolbar' },
{ id: 'q1', toolbarId: 'q1Toolbar' },
{ id: 'q2', toolbarId: 'q2Toolbar' },
{ id: 'q3', toolbarId: 'q3Toolbar' }
];
textareas.forEach(({ id, toolbarId }) => {
initToolbarForEditable(id, toolbarId);
});
}
function initToolbarForEditable(editableId, toolbarId) {
const editable = document.getElementById(editableId);
const toolbar = document.getElementById(toolbarId);
if (!editable || !toolbar) return;
toolbar.querySelectorAll('.format-btn').forEach(btn => {
btn.addEventListener('click', function(e) {
const action = this.dataset.action;
if (!editable.contains(document.activeElement) && document.activeElement !== editable) {
editable.focus();
}
activeEditable = editable;
if (action === 'quick-phrase') {
e.preventDefault();
e.stopPropagation();
showQuickPhraseMenu(this, editable);
return;
}
const selection = window.getSelection();
let range = null;
if (selection.rangeCount > 0) {
range = selection.getRangeAt(0);
const container = range.commonAncestorContainer;
if (!editable.contains(container) && container !== editable) {
return;
}
}
if (action === 'bold') {
document.execCommand('bold', false, null);
} else if (action === 'italic') {
document.execCommand('italic', false, null);
} else if (action === 'underline') {
document.execCommand('underline', false, null);
} else if (action === 'ordered') {
document.execCommand('insertOrderedList', false, null);
} else if (action === 'unordered') {
document.execCommand('insertUnorderedList', false, null);
} else if (action === 'indent-increase') {
document.execCommand('indent', false, null);
} else if (action === 'indent-decrease') {
document.execCommand('outdent', false, null);
}
updateToolbarButtons(editable);
editable.focus();
});
});
}
function showQuickPhraseMenu(button, editable) {
if (!quickPhraseMenu || !editable) return;
if (!editable.contains(document.activeElement) && document.activeElement !== editable) {
editable.focus();
}
hideQuickPhraseMenu();
activeEditable = editable;
const editableId = editable.id;
let phrasesHTML = '';
if (editableId === 'readingComment') {
phrasesHTML = `
<div class="quick-phrase-item" data-phrase="роУро░ро│ро╡рпБ родропроХрпНроХродрпНродрпБроЯройрпН"><i class="fas fa-clock"></i>роУро░ро│ро╡рпБ родропроХрпНроХродрпНродрпБроЯройрпН</div>
<div class="quick-phrase-item" data-phrase="роЪро┐ро▓ роЗроЯроЩрпНроХро│ро┐ро▓рпН родроЯрпБрооро╛ро▒рпНро▒роорпН"><i class="fas fa-pause"></i>роЪро┐ро▓ роЗроЯроЩрпНроХро│ро┐ро▓рпН родроЯрпБрооро╛ро▒рпНро▒роорпН</div>
<div class="quick-phrase-item" data-phrase="роЙроЪрпНроЪро░ро┐рокрпНрокрпБрокрпН рокро┐ро┤рпИроХро│рпН"><i class="fas fa-volume-mute"></i>роЙроЪрпНроЪро░ро┐рокрпНрокрпБрокрпН рокро┐ро┤рпИроХро│рпН</div>
<div class="quick-phrase-item" data-phrase="роорпЗро▓рпБроорпН рокропро┐ро▒рпНроЪро┐ родрпЗро╡рпИ"><i class="fas fa-dumbbell"></i>роорпЗро▓рпБроорпН рокропро┐ро▒рпНроЪро┐ родрпЗро╡рпИ</div>
`;
} else if (['q1', 'q2', 'q3'].includes(editableId)) {
phrasesHTML = `
<div class="quick-phrase-item" data-phrase="роЖроЪро┐ро░ро┐ропро░рпН ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпН родрпЗро╡рпИ"><i class="fas fa-hands-helping"></i>роЖроЪро┐ро░ро┐ропро░рпН ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпН родрпЗро╡рпИ</div>
<div class="quick-phrase-item" data-phrase="рокродро┐ро▓рпН роХрпЗро│рпНро╡ро┐ропрпЛроЯрпБ роТроЯрпНроЯро╡ро┐ро▓рпНро▓рпИ"><i class="fas fa-exclamation-circle"></i>рокродро┐ро▓рпН роХрпЗро│рпНро╡ро┐ропрпЛроЯрпБ роТроЯрпНроЯро╡ро┐ро▓рпНро▓рпИ</div>
<div class="quick-phrase-item" data-phrase="роХро░рпБродрпНродрпБ ро╡ро┐ро░ро┐ро╡ро╛роХрпНроХроорпН роЗро▓рпНро▓рпИ"><i class="fas fa-compress-alt"></i>роХро░рпБродрпНродрпБ ро╡ро┐ро░ро┐ро╡ро╛роХрпНроХроорпН роЗро▓рпНро▓рпИ</div>
<div class="quick-phrase-item" data-phrase="рокрпКро░рпБродрпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпН ЁЯСН"><i class="fas fa-thumbs-up"></i>рокрпКро░рпБродрпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпН ЁЯСН</div>
<div class="quick-phrase-item" data-phrase="ро╡ро┐ро│роХрпНроХроорпН родрпЖро│ро┐ро╡ро╛роХ роЙро│рпНро│родрпБ"><i class="fas fa-star"></i>ро╡ро┐ро│роХрпНроХроорпН родрпЖро│ро┐ро╡ро╛роХ роЙро│рпНро│родрпБ</div>
`;
} else {
return;
}
quickPhraseMenu.innerHTML = phrasesHTML;
const rect = button.getBoundingClientRect();
let posX = rect.left + window.scrollX;
let posY = rect.bottom + window.scrollY + 5;
quickPhraseMenu.style.display = 'block';
quickPhraseMenu.style.position = 'absolute';
quickPhraseMenu.style.left = posX + 'px';
quickPhraseMenu.style.top = posY + 'px';
quickPhraseMenu.style.zIndex = '9999';
setTimeout(() => {
const menuRect = quickPhraseMenu.getBoundingClientRect();
const viewportWidth = window.innerWidth;
const viewportHeight = window.innerHeight;
if (menuRect.right > viewportWidth - 10) {
const overflow = menuRect.right - viewportWidth + 10;
quickPhraseMenu.style.left = (posX - overflow) + 'px';
}
if (menuRect.bottom > viewportHeight - 10) {
const newTop = posY - menuRect.height - rect.height - 10;
quickPhraseMenu.style.top = newTop + 'px';
}
}, 0);
}
function insertPhraseAtCursor(textContent) {
if (!activeEditable) return;
try {
if (!activeEditable.contains(document.activeElement) && document.activeElement !== activeEditable) {
activeEditable.focus();
}
const selection = window.getSelection();
let range = null;
if (lastSavedRange) {
const container = lastSavedRange.commonAncestorContainer;
if (activeEditable.contains(container) || container === activeEditable) {
range = lastSavedRange;
selection.removeAllRanges();
selection.addRange(range);
}
lastSavedRange = null;
} else if (selection.rangeCount > 0) {
range = selection.getRangeAt(0);
const container = range.commonAncestorContainer;
if (!activeEditable.contains(container) && container !== activeEditable) {
range = document.createRange();
range.selectNodeContents(activeEditable);
range.collapse(false);
selection.removeAllRanges();
selection.addRange(range);
}
}
if (range && (activeEditable.contains(range.commonAncestorContainer) || range.commonAncestorContainer === activeEditable)) {
range.deleteContents();
const textNode = document.createTextNode(textContent);
range.insertNode(textNode);
range = range.cloneRange();
range.setStartAfter(textNode);
range.collapse(true);
selection.removeAllRanges();
selection.addRange(range);
} else {
const textNode = document.createTextNode(textContent);
activeEditable.appendChild(textNode);
const newRange = document.createRange();
newRange.selectNodeContents(activeEditable);
newRange.collapse(false);
selection.removeAllRanges();
selection.addRange(newRange);
}
activeEditable.dispatchEvent(new Event('input', { bubbles: true }));
} catch (error) {
console.error('Gagal memasukkan frasa:', error);
activeEditable.textContent += textContent;
activeEditable.focus();
}
}
function initQuickPhraseMenu() {
const existingMenu = document.querySelector('.quick-phrase-menu');
if (existingMenu) {
existingMenu.remove();
}
quickPhraseMenu = document.createElement('div');
quickPhraseMenu.className = 'quick-phrase-menu';
quickPhraseMenu.style.display = 'none';
document.body.appendChild(quickPhraseMenu);
quickPhraseMenu.addEventListener('click', function(e) {
e.stopPropagation();
const menuItem = e.target.closest('.quick-phrase-item');
if (!menuItem || !activeEditable) return;
const phrase = menuItem.dataset.phrase;
if (phrase) {
insertPhraseAtCursor(phrase + ' ');
}
hideQuickPhraseMenu();
});
document.addEventListener('click', function(e) {
if (!quickPhraseMenu.contains(e.target) && !e.target.closest('.format-btn[data-action="quick-phrase"]')) {
hideQuickPhraseMenu();
}
});
document.addEventListener('keydown', function(e) {
if (e.key === 'Escape' && quickPhraseMenu.style.display === 'block') {
hideQuickPhraseMenu();
}
});
}
function hideQuickPhraseMenu() {
if (quickPhraseMenu) {
quickPhraseMenu.style.display = 'none';
quickPhraseMenu.innerHTML = '';
}
}
function bindQuickPhraseButtons() {
const quickPhraseButtons = document.querySelectorAll('.format-btn[data-action="quick-phrase"]');
quickPhraseButtons.forEach(btn => {
btn.replaceWith(btn.cloneNode(true));
});
document.querySelectorAll('.format-btn[data-action="quick-phrase"]').forEach(btn => {
btn.addEventListener('mousedown', function(e) {
const selection = window.getSelection();
if (selection.rangeCount > 0) {
const range = selection.getRangeAt(0);
const container = range.commonAncestorContainer;
const editable = this.closest('.text-format-container')?.querySelector('.editable-content');
if (editable && (editable.contains(container) || container === editable)) {
lastSavedRange = range.cloneRange();
}
}
});
btn.addEventListener('click', function(e) {
e.preventDefault();
e.stopPropagation();
const container = this.closest('.text-format-container');
if (!container) return;
const editable = container.querySelector('.editable-content');
if (!editable) return;
if (!editable.contains(document.activeElement) && document.activeElement !== editable) {
editable.focus();
}
showQuickPhraseMenu(this, editable);
});
});
}
function initContextMenu() {
contextMenu = document.createElement('div');
contextMenu.className = 'context-menu';
contextMenu.innerHTML = `
<div class="context-menu-item" data-action="bold"><i class="fas fa-bold"></i>родроЯро┐родрпНрод</div>
<div class="context-menu-item" data-action="italic"><i class="fas fa-italic"></i>роЪро╛ропрпНро╡рпБ</div>
<div class="context-menu-item" data-action="underline"><i class="fas fa-underline"></i>роЕроЯро┐роХрпНроХрпЛроЯрпБ</div>
<div class="context-menu-divider"></div>
<div class="context-menu-item" data-action="ordered"><i class="fas fa-list-ol"></i>роОрогрпНрогро┐роЯрокрпНрокроЯрпНроЯ рокроЯрпНроЯро┐ропро▓рпН</div>
<div class="context-menu-item" data-action="unordered"><i class="fas fa-list-ul"></i>рокрпБро▓рпНро▓роЯрпНроЯрпБроХро│рпН</div>
<div class="context-menu-divider"></div>
<div class="context-menu-item" data-action="indent-increase"><i class="fas fa-indent"></i>роЙро│рпНродро│рпНро│ро▓рпИ роЕродро┐роХро░ро┐</div>
<div class="context-menu-item" data-action="indent-decrease"><i class="fas fa-outdent"></i>роЙро│рпНродро│рпНро│ро▓рпИроХрпН роХрпБро▒рпИ</div>
`;
document.body.appendChild(contextMenu);
contextMenu.addEventListener('click', function(e) {
const menuItem = e.target.closest('.context-menu-item');
if (!menuItem) return;
const action = menuItem.dataset.action;
if (activeEditable && action) {
applyFormatting(activeEditable, action);
}
hideContextMenu();
});
document.addEventListener('click', function(e) {
if (!contextMenu.contains(e.target)) {
hideContextMenu();
}
});
contextMenu.addEventListener('contextmenu', function(e) {
e.preventDefault();
});
const editableIds = ['readingComment', 'q1', 'q2', 'q3'];
editableIds.forEach(id => {
const editable = document.getElementById(id);
if (editable) {
editable.setAttribute('spellcheck', 'false');
editable.addEventListener('contextmenu', function(e) {
e.preventDefault();
activeEditable = editable;
showContextMenu(e.clientX, e.clientY);
updateToolbarButtons(editable);
});
}
});
}
function showContextMenu(x, y) {
contextMenu.style.display = 'block';
contextMenu.style.left = x + 'px';
contextMenu.style.top = y + 'px';
const rect = contextMenu.getBoundingClientRect();
if (rect.right > window.innerWidth) {
contextMenu.style.left = (x - rect.width) + 'px';
}
if (rect.bottom > window.innerHeight) {
contextMenu.style.top = (y - rect.height) + 'px';
}
}
function hideContextMenu() {
contextMenu.style.display = 'none';
}
function applyFormatting(editable, action) {
editable.focus();
switch (action) {
case 'bold': document.execCommand('bold', false, null); break;
case 'italic': document.execCommand('italic', false, null); break;
case 'underline': document.execCommand('underline', false, null); break;
case 'ordered': document.execCommand('insertOrderedList', false, null); break;
case 'unordered': document.execCommand('insertUnorderedList', false, null); break;
case 'indent-increase': document.execCommand('indent', false, null); break;
case 'indent-decrease': document.execCommand('outdent', false, null); break;
}
updateToolbarButtons(editable);
}
// ========== хнжчФЯшо░х╜ХчЫ╕хЕ│хЗ╜цХ░ ==========
function saveStudent() {
const name = document.getElementById('name').value.trim();
const studentClass = document.getElementById('class').value.trim();
const teacher = document.getElementById('teacher').value.trim();
if (!name || !studentClass || !teacher) {
alert('родропро╡рпБроЪрпЖропрпНродрпБ рооро╛рогро╡ро░ро┐ройрпН рокрпЖропро░рпН, ро╡роХрпБрокрпНрокрпБ рооро▒рпНро▒рпБроорпН родрооро┐ро┤ро╛роЪро┐ро░ро┐ропро░ро┐ройрпН рокрпЖропро░рпИ роиро┐ро░рокрпНрокро╡рпБроорпН!');
return;
}
const mistakes = [];
document.querySelectorAll('.word.mistake').forEach(word => {
mistakes.push({ index: word.dataset.index, text: word.textContent });
});
const studentData = {
id: Date.now(),
name: name,
class: studentClass,
teacher: teacher,
date: new Date().toLocaleDateString('ta-MY'),
readingScore: scores.reading,
contentScore: scores.content,
expressionScore: scores.expression,
totalScore: (scores.reading || 0) + (scores.content || 0) + (scores.expression || 0),
readingComment: document.getElementById('readingComment').innerHTML,
q1: document.getElementById('q1').innerHTML,
q2: document.getElementById('q2').innerHTML,
q3: document.getElementById('q3').innerHTML,
mistakes: mistakes,
passage: PASSAGE,
prompts: [...CONVERSATION_PROMPTS]
};
let records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
records.push(studentData);
localStorage.setItem(currentGrade + '_records', JSON.stringify(records));
loadRecords();
resetCurrent();
alert('рооро╛рогро╡ро░рпН рокродро┐ро╡рпБ роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
}
function loadRecords() {
const records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
const recordList = document.getElementById('recordList');
recordList.innerHTML = '';
records.forEach((record, index) => {
const row = document.createElement('tr');
row.innerHTML = `
<td class="record-text">${record.name}</td>
<td class="record-text">${record.class}</td>
<td class="record-text">${record.teacher}</td>
<td class="record-number">${record.readingScore || 0}</td>
<td class="record-number">${record.contentScore || 0}</td>
<td class="record-number">${record.expressionScore || 0}</td>
<td class="record-number">${record.totalScore || 0}</td>
<td class="record-text"><button class="delete-btn" onclick="deleteRecord(${record.id})">роирпАроХрпНроХрпБ</button></td>
`;
recordList.appendChild(row);
});
}
function deleteRecord(id) {
if (!confirm('роЗроирпНродрокрпН рокродро┐ро╡рпИ роиро┐роЪрпНроЪропрооро╛роХ роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) return;
let records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
records = records.filter(record => record.id !== id);
localStorage.setItem(currentGrade + '_records', JSON.stringify(records));
loadRecords();
}
function resetCurrent() {
document.getElementById('name').value = '';
document.getElementById('class').value = '';
document.getElementById('teacher').value = '';
scores = { reading: 0, content: 0, expression: 0 };
document.querySelectorAll('.score-btn.selected').forEach(btn => {
btn.classList.remove('selected');
});
document.querySelectorAll('.score-value').forEach(el => {
el.textContent = '0';
el.setAttribute('data-initial', 'true');
});
document.getElementById('readingComment').innerHTML = '';
document.getElementById('q1').innerHTML = '';
document.getElementById('q2').innerHTML = '';
document.getElementById('q3').innerHTML = '';
document.querySelectorAll('.word.mistake').forEach(word => {
word.classList.remove('mistake');
});
}
function showRevisionStudentList() {
const records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
if (records.length === 0) {
alert('родро┐ро░рпБродрпНродрпБро╡родро▒рпНроХрпБ роОроирпНродрокрпН рокродро┐ро╡рпБроорпН роЗро▓рпНро▓рпИ!');
return;
}
const modal = document.createElement('div');
modal.className = 'revision-modal';
modal.innerHTML = `
<div class="revision-modal-content">
<h3>родро┐ро░рпБродрпНродрпБро╡родро▒рпНроХро╛рой рооро╛рогро╡ро░рпН рокродро┐ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</h3>
<table class="revision-student-table">
<thead><tr><th>рокрпЖропро░рпН</th><th>ро╡роХрпБрокрпНрокрпБ</th><th>родрооро┐ро┤ро╛роЪро┐ро░ро┐ропро░рпН</th><th>ро╡ро╛роЪро┐рокрпНрокрпБ</th><th>роЙро│рпНро│роЯроХрпНроХроорпН</th><th>роорпКро┤ро┐</th><th>роорпКродрпНродроорпН</th><th>роЪрпЖропро▓рпН</th></tr></thead>
<tbody id="revisionStudentList">
${records.map((record, index) => `
<tr><td>${record.name}</td><td>${record.class}</td><td>${record.teacher}</td><td>${record.readingScore || 0}</td><td>${record.contentScore || 0}</td><td>${record.expressionScore || 0}</td><td>${record.totalScore || 0}</td><td><button class="revision-edit-btn" onclick="enterRevisionMode(${index})"><i class="fas fa-edit"></i> родро┐ро░рпБродрпНродрпБ</button></td></tr>
`).join('')}
</tbody>
</table>
<div style="text-align: center; margin-top: 20px;"><button class="revision-close-btn" onclick="this.closest('.revision-modal').remove()">роорпВроЯрпБ</button></div>
</div>
`;
document.body.appendChild(modal);
}
function enterRevisionMode(index) {
const records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
const record = records[index];
if (!record) {
alert('рокродро┐ро╡рпБ роЗро▓рпНро▓рпИ!');
return;
}
originalData = { ...record };
currentEditIndex = index;
isRevisionMode = true;
document.getElementById('name').value = record.name;
document.getElementById('class').value = record.class;
document.getElementById('teacher').value = record.teacher;
if (record.readingScore !== null) { setScore('reading', record.readingScore); } else { updateScoreDisplay('reading', 0); }
if (record.contentScore !== null) { setScore('content', record.contentScore); } else { updateScoreDisplay('content', 0); }
if (record.expressionScore !== null) { setScore('expression', record.expressionScore); } else { updateScoreDisplay('expression', 0); }
document.getElementById('readingComment').innerHTML = record.readingComment || '';
document.getElementById('q1').innerHTML = record.q1 || '';
document.getElementById('q2').innerHTML = record.q2 || '';
document.getElementById('q3').innerHTML = record.q3 || '';
document.querySelectorAll('.word.mistake').forEach(word => { word.classList.remove('mistake'); });
if (record.mistakes && record.mistakes.length > 0) {
record.mistakes.forEach(mistake => {
const word = document.querySelector(`.word[data-index="${mistake.index}"]`);
if (word) { word.classList.add('mistake'); }
});
}
document.body.classList.add('revision-mode');
document.getElementById('revisionBottomBar').style.display = 'block';
const modal = document.querySelector('.revision-modal');
if (modal) modal.remove();
alert('родро┐ро░рпБродрпНродрпБроорпН роорпБро▒рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯродрпБ. роорпБроЯро┐роирпНродродрпБроорпН "родро┐ро░рпБродрпНродроЩрпНроХро│рпИроЪрпН роЪрпЗрооро┐" роОройрпНрокродрпИроХрпН роХро┐ро│ро┐роХрпН роЪрпЖропрпНропро╡рпБроорпН.');
}
function setScore(type, score) {
scores[type] = score;
updateScoreDisplay(type, score);
document.querySelectorAll(`.score-buttons[data-type="${type}"] .score-btn`).forEach(btn => {
btn.classList.remove('selected');
if (parseInt(btn.dataset.score) === score) { btn.classList.add('selected'); }
});
}
function saveRevision() {
if (currentEditIndex === null) return;
const records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
const name = document.getElementById('name').value.trim();
const studentClass = document.getElementById('class').value.trim();
const teacher = document.getElementById('teacher').value.trim();
if (!name || !studentClass || !teacher) {
alert('родропро╡рпБроЪрпЖропрпНродрпБ рооро╛рогро╡ро░ро┐ройрпН рокрпЖропро░рпН, ро╡роХрпБрокрпНрокрпБ рооро▒рпНро▒рпБроорпН родрооро┐ро┤ро╛роЪро┐ро░ро┐ропро░ро┐ройрпН рокрпЖропро░рпИ роиро┐ро░рокрпНрокро╡рпБроорпН!');
return;
}
const mistakes = [];
document.querySelectorAll('.word.mistake').forEach(word => {
mistakes.push({ index: word.dataset.index, text: word.textContent });
});
records[currentEditIndex] = {
...records[currentEditIndex],
name: name,
class: studentClass,
teacher: teacher,
readingScore: scores.reading,
contentScore: scores.content,
expressionScore: scores.expression,
totalScore: (scores.reading || 0) + (scores.content || 0) + (scores.expression || 0),
readingComment: document.getElementById('readingComment').innerHTML,
q1: document.getElementById('q1').innerHTML,
q2: document.getElementById('q2').innerHTML,
q3: document.getElementById('q3').innerHTML,
mistakes: mistakes,
revisedAt: new Date().toLocaleString('ta-MY')
};
localStorage.setItem(currentGrade + '_records', JSON.stringify(records));
cancelRevision();
loadRecords();
alert('родро┐ро░рпБродрпНродроЩрпНроХро│рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯрой!');
}
function cancelRevision() {
isRevisionMode = false;
currentEditIndex = null;
originalData = {};
document.body.classList.remove('revision-mode');
document.getElementById('revisionBottomBar').style.display = 'none';
resetCurrent();
}
function generatePDF(includeRubric = false) {
const records = JSON.parse(localStorage.getItem(currentGrade + '_records') || '[]');
if (records.length === 0) {
alert('рооро╛рогро╡ро░рпН рокродро┐ро╡рпБроХро│рпН роОродрпБро╡рпБроорпН роЗро▓рпНро▓рпИ!');
return;
}
function htmlToPrint(html) {
if (!html || html.trim() === '') return 'тАФтАФ';
const temp = document.createElement('div');
temp.innerHTML = html;
temp.querySelectorAll('i.fas, i.far').forEach(icon => {
const classNames = icon.className;
let replacement = '';
if (classNames.includes('fa-check-circle')) replacement = '[тЬУ] ';
else if (classNames.includes('fa-star')) replacement = '[тнР] ';
else if (classNames.includes('fa-thumbs-up')) replacement = '[ЁЯСН] ';
else if (classNames.includes('fa-lightbulb')) replacement = '[ЁЯТб] ';
else if (classNames.includes('fa-exclamation-triangle')) replacement = '[тЪая╕П] ';
else if (classNames.includes('fa-plus-circle')) replacement = '[+] ';
else if (classNames.includes('fa-search')) replacement = '[ЁЯФН] ';
else if (classNames.includes('fa-expand-alt')) replacement = '[тЖФя╕П] ';
else if (classNames.includes('fa-volume-up')) replacement = '[ЁЯФК] ';
else if (classNames.includes('fa-book-reader')) replacement = '[ЁЯУЦ] ';
else if (classNames.includes('fa-tachometer-alt')) replacement = '[тП▒я╕П] ';
if (replacement) {
const span = document.createElement('span');
span.textContent = replacement;
icon.parentNode.replaceChild(span, icon);
} else {
icon.remove();
}
});
temp.querySelectorAll('b, strong, i, em, u').forEach(el => {
el.replaceWith(document.createTextNode(el.textContent));
});
temp.querySelectorAll('ol, ul').forEach(list => {
const items = Array.from(list.children);
const isOrdered = list.tagName === 'OL';
let listText = '';
items.forEach((li, index) => {
let itemText = (li.textContent || li.innerText || '').trim();
if (isOrdered) { listText += `${index + 1}. ${itemText}\n`; } else { listText += `тАв ${itemText}\n`; }
});
list.parentNode.replaceChild(document.createTextNode(listText), list);
});
temp.querySelectorAll('li').forEach(li => {
li.replaceWith(document.createTextNode(li.textContent || li.innerText));
});
return (temp.innerText || temp.textContent || '').trim() || 'тАФтАФ';
}
function generateMarkedPassage(passageText, mistakes) {
if (!mistakes || mistakes.length === 0) {
// ц▓бцЬЙщФЩшппцаЗшо░цЧ╢я╝МцМЙцо╡шР╜ш┐ФхЫЮ HTML
const paragraphs = passageText.split(/\n\s*\n/);
let html = '';
paragraphs.forEach((para, idx) => {
const trimmed = para.trim();
if (trimmed) {
html += '<p>' + trimmed + '</p>';
if (idx < paragraphs.length - 1) html += '\n';
}
});
return html;
}
const mistakeIndexMap = {};
mistakes.forEach(mistake => {
const index = typeof mistake.index === 'string' ? parseInt(mistake.index) : mistake.index;
if (!isNaN(index)) mistakeIndexMap[index] = true;
});
// цМЙхПМцНвшбМчмжхИЖхЙ▓цо╡шР╜я╝Мф┐ЭчХЩцо╡шР╜ч╗УцЮД
const paragraphs = passageText.split(/\n\s*\n/);
let markedHTML = '';
paragraphs.forEach((paragraph, pIndex) => {
const trimmedPara = paragraph.trim();
if (trimmedPara) {
markedHTML += '<p>';
const chars = trimmedPara.split('');
chars.forEach((char, cIndex) => {
const globalIndex = pIndex * 10000 + cIndex;
if (mistakeIndexMap[globalIndex]) {
markedHTML += `<span class="word mistake">${char}</span>`;
} else {
markedHTML += `<span class="word">${char}</span>`;
}
});
markedHTML += '</p>';
if (pIndex < paragraphs.length - 1) markedHTML += '\n';
}
});
return markedHTML;
}
const isEdge = /Edg\//.test(navigator.userAgent);
const isChrome = /Chrome/.test(navigator.userAgent) && !isEdge;
// щЗЗчФищймцЭецЦЗчЙИчЪД PDF ца╖х╝Пя╝Мч▓╛хЗЖш░ГцХ┤хИЧхо╜
let html = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ро╡ро╛ропрпНроорпКро┤ро┐роХрпН роХро░рпБродрпНродрпБрокрпН рокроЯро┐ро╡роорпН</title><style>
@page { margin: 12mm 12mm 15mm 12mm; size: A4; }
body { font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif; font-size: 11pt; line-height: 1.5; margin: 0; padding: 0; background: white; letter-spacing: normal; }
.page { width: 100%; height: auto; page-break-inside: avoid; }
.report-title { text-align: center; font-size: 16pt; font-weight: bold; margin: 5pt 0 8pt 0; }
.student-info { text-align: center; font-size: 10pt; margin: 0 0 8pt 0; }
.main-table { width: 96%; margin-left: 2%; margin-right: 2%; border-collapse: collapse; font-size: 10pt; line-height: 1.5; table-layout: fixed; page-break-inside: avoid; }
.main-table col:nth-child(1) { width: 13%; } .main-table col:nth-child(2) { width: 13%; } .main-table col:nth-child(3) { width: 25%; } .main-table col:nth-child(4) { width: 25%; } .main-table col:nth-child(5) { width: 24%; }
.main-table th, .main-table td { border: 1pt solid #000; padding: 4pt 3pt; vertical-align: middle; text-align: center; }
.score-header, .total-cell { padding: 5pt 4pt !important; line-height: 1.5; font-size: 10pt; background: #f0f0f0; font-weight: normal; }
.left-first-col, .question-cell { text-align: center; vertical-align: middle; background: #f8f8f8; font-weight: normal; line-height: 1.3; padding: 4pt 3pt !important; word-break: keep-all; }
.total-cell { background: #f0f8f0; }
td[colspan="3"] { width: 74%; min-width: 74%; max-width: 74%; }
.reading-passage {
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif;
font-size: 9pt;
line-height: 1.6;
text-align: justify !important;
text-justify: inter-ideograph !important;
position: relative;
letter-spacing: normal;
word-break: break-word;
overflow-wrap: break-word;
hyphens: none;
width: 100%;
}
.reading-passage p {
margin: 0 0 10pt 0 !important;
line-height: 1.6;
text-align: justify !important;
text-justify: inter-ideograph !important;
display: block !important;
}
.reading-passage p:last-child {
margin-bottom: 0 !important;
}
.reading-passage .word {
display: inline !important;
position: relative !important;
font-family: 'Arial Unicode MS', 'Latha', 'Arial Narrow', Arial, Helvetica, sans-serif !important;
font-weight: 400 !important;
font-size: 9pt !important;
line-height: 1.6 !important;
padding: 0 !important;
margin: 0 !important;
color: #000 !important;
background: transparent !important;
border: none !important;
border-radius: 0 !important;
}
.reading-passage .word.mistake {
text-decoration: underline !important;
text-decoration-color: #b91c1c !important;
text-decoration-thickness: 1pt !important;
-webkit-text-decoration: underline !important;
-webkit-text-decoration-color: #b91c1c !important;
}
.reading-comment, .conversation-content { font-size: 9pt; line-height: 1.4; text-align: left; white-space: pre-wrap; word-wrap: break-word; padding: 3pt; }
.reading-comment { min-height: 5mm; } .conversation-content { min-height: 8mm; }
.reading-comment:empty::before, .conversation-content:empty::before { content: "тАФтАФ"; color: #999; }
.appendix-page { page-break-before: always !important; page-break-inside: avoid !important; margin: 0; padding: 0; width: 100%; display: block; }
.appendix-title { text-align: center; font-size: 14pt; font-weight: bold; margin: 4mm 0 6mm 0; padding-bottom: 2mm; }
.rubric-section-title { width: 96%; text-align: left; font-size: 12pt; font-weight: bold; margin: 5mm 0 3mm 0; padding-left: 2%; }
.appendix-content { width: 100%; display: block; }
.appendix-table { width: 96%; margin: 0 auto; border-collapse: collapse; table-layout: fixed; font-size: 9pt !important; line-height: 1.4 !important; }
.appendix-table th, .appendix-table td { border: 0.75pt solid #333; vertical-align: top; font-weight: normal; padding: 4pt 3pt !important; }
.appendix-table th { background: #f5f5f5; font-weight: bold; text-align: center; }
/* ч▓╛хЗЖш░ГцХ┤хИЧхо╜я╝ЪхЖЕхо╣хИЧш░Гхо╜я╝Мшбиш╛╛хИЧш░ГчкД */
.appendix-table.reading-table th:nth-child(1), .appendix-table.reading-table td:nth-child(1) { width: 6%; text-align: center; }
.appendix-table.reading-table th:nth-child(2), .appendix-table.reading-table td:nth-child(2) { width: 9%; text-align: center; }
.appendix-table.reading-table th:nth-child(3), .appendix-table.reading-table td:nth-child(3) { width: 42.5%; text-align: left; }
.appendix-table.reading-table th:nth-child(4), .appendix-table.reading-table td:nth-child(4) { width: 42.5%; text-align: left; }
.appendix-table.conversation-table th:nth-child(1), .appendix-table.conversation-table td:nth-child(1) { width: 6%; text-align: center; }
.appendix-table.conversation-table th:nth-child(2), .appendix-table.conversation-table td:nth-child(2) { width: 9%; text-align: center; }
.appendix-table.conversation-table th:nth-child(3), .appendix-table.conversation-table td:nth-child(3) { width: 40%; text-align: left; }
.appendix-table.conversation-table th:nth-child(4), .appendix-table.conversation-table td:nth-child(4) { width: 9%; text-align: center; }
.appendix-table.conversation-table th:nth-child(5), .appendix-table.conversation-table td:nth-child(5) { width: 36%; text-align: left; }
.appendix-table ul { padding-left: 14px !important; margin: 2px 0 !important; font-size: 8.5pt !important; line-height: 1.4 !important; }
.appendix-table li { margin-bottom: 1px !important; }
@media print {
.appendix-table th { padding: 4pt 3pt !important; font-size: 9pt; line-height: 1.4; }
.appendix-table td { padding: 4pt 3pt !important; font-size: 9pt; line-height: 1.4; }
.appendix-table ul { padding-left: 14px !important; margin: 2px 0 !important; font-size: 8.5pt !important; line-height: 1.4 !important; }
body.is-chrome { padding: 0; }
body.is-chrome .main-table { width: 88%; margin-left: 6%; margin-right: 6%; }
body.is-chrome .rubric-section-title { width: 88%; padding-left: 6%; }
body.is-chrome .appendix-table { width: 88%; font-size: 9.5pt !important; line-height: 1.5 !important; }
body.is-chrome .appendix-title { margin: 6mm 0 8mm 0; }
body.is-chrome .rubric-section-title { margin: 8mm 0 4mm 0; }
body.is-chrome .appendix-table th { padding: 6pt 4pt !important; font-size: 9.5pt; line-height: 1.5; }
body.is-chrome .appendix-table td { padding: 6pt 4pt !important; font-size: 9.5pt; line-height: 1.5; }
body.is-chrome .appendix-table ul { padding-left: 16px !important; margin: 3px 0 !important; font-size: 9pt !important; line-height: 1.4 !important; }
}
@media print and (-ms-high-contrast: active), (-ms-high-contrast: none) {
.appendix-page { margin-top: 5mm !important; }
.appendix-title { margin: 6mm 0 5mm 0 !important; font-size: 13pt !important; }
.rubric-section-title { margin: 5mm 0 3mm 0 !important; font-size: 11pt !important; }
.appendix-table { font-size: 8.5pt !important; line-height: 1.4 !important; }
.appendix-table th, .appendix-table td { padding: 4pt 3pt !important; }
.appendix-table ul { padding-left: 12px !important; margin: 1px 0 !important; font-size: 8pt !important; line-height: 1.3 !important; }
}
</style></head><body>`;
records.forEach((rec, index) => {
const r = rec.readingScore || 0;
const c = rec.contentScore || 0;
const e = rec.expressionScore || 0;
const total = r + c + e;
const passageText = rec.passage || PASSAGE;
const prompts = rec.prompts || CONVERSATION_PROMPTS;
const markedPassage = generateMarkedPassage(passageText, rec.mistakes || []);
const readingComment = htmlToPrint(rec.readingComment);
const q1Feedback = htmlToPrint(rec.q1);
const q2Feedback = htmlToPrint(rec.q2);
const q3Feedback = htmlToPrint(rec.q3);
const q1Text = prompts[0] || "ро╡ро┐ройро╛ 1";
const q2Text = prompts[1] || "ро╡ро┐ройро╛ 2";
const q3Text = prompts[2] || "ро╡ро┐ройро╛ 3";
html += `
<div class="page">
<h1 class="report-title">ро╡ро╛ропрпНроорпКро┤ро┐роХрпН роХро░рпБродрпНродрпБрокрпН рокроЯро┐ро╡роорпН</h1>
<div class="student-info">рокрпЖропро░рпНя╝Ъ${rec.name || 'тАФтАФ'} ро╡роХрпБрокрпНрокрпБя╝Ъ${rec.class || 'тАФтАФ'} родрооро┐ро┤ро╛роЪро┐ро░ро┐ропро░рпНя╝Ъ${rec.teacher || 'тАФтАФ'}</div>
<table class="main-table"><colgroup><col><col><col><col><col></colgroup>
<tr><td class="left-first-col" rowspan="2">роородро┐рокрпНрокрпЖрогрпН<br>роЪрпБро░рпБроХрпНроХроорпН</td><th class="score-header">ро╡ро╛роЪро┐рокрпНрокрпБ</th><th class="score-header">роЙро░рпИропро╛роЯро▓рпН┬╖роЙро│рпНро│роЯроХрпНроХроорпН</th><th class="score-header">роЙро░рпИропро╛роЯро▓рпН┬╖роорпКро┤ро┐</th><th class="total-cell">роорпКродрпНродроорпН</th></tr>
<tr><td class="score-cell">${r}/10</td><td class="score-cell">${c}/20</td><td class="score-cell">${e}/20</td><td class="total-cell">${total}/50</td></tr>
<tr><td class="left-first-col" rowspan="2">ро╡ро╛роЪро┐рокрпНрокрпБроХрпН<br>роХро░рпБродрпНродрпБ</td><td class="question-cell">рокро┐ро┤рпИроХро│рпН<br>роХрпБро▒ро┐роХрпНроХрокрпНрокроЯрпНроЯрой</td><td colspan="3" style="text-align: left; padding: 5pt;"><div class="reading-passage">${markedPassage}</div></td></tr>
<tr><td class="question-cell">роХро░рпБродрпНродрпБ</td><td colspan="3" style="text-align: left; padding: 5pt;"><div class="reading-comment">${readingComment}</div></td></tr>
<tr><td class="left-first-col" rowspan="3">роЙро░рпИропро╛роЯро▓рпН<br>роХро░рпБродрпНродрпБ</td><td class="question-cell">ро╡ро┐ройро╛ 1</td><td colspan="3" style="text-align: left;"><div class="conversation-content"><strong>${q1Text}</strong><br>${q1Feedback}</div></td></tr>
<tr><td class="question-cell">ро╡ро┐ройро╛ 2</td><td colspan="3" style="text-align: left;"><div class="conversation-content"><strong>${q2Text}</strong><br>${q2Feedback}</div></td></tr>
<tr><td class="question-cell">ро╡ро┐ройро╛ 3</td><td colspan="3" style="text-align: left;"><div class="conversation-content"><strong>${q3Text}</strong><br>${q3Feedback}</div></td></tr>
</table></div>`;
if (includeRubric) {
html += `
<div class="appendix-page">
<h2 class="appendix-title">(роЗрогрпИрокрпНрокрпБ) роородро┐рокрпНрокрпАроЯрпНроЯрпБродрпН родро┐роЯрпНроЯроорпН</h2>
<div class="appendix-content">
<div style="width: 100%;">
<div class="rubric-section-title">рокроХрпБродро┐ 1: ро╡ро╛ропрпНро╡ро┐роЯрпНроЯрпБ ро╡ро╛роЪро┐родрпНродро▓рпН (10 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</div>
<table class="appendix-table reading-table">
<thead><tr><th>роиро┐ро▓рпИ</th><th>роородро┐рокрпНрокрпЖрогрпНроХро│рпН</th><th>роЙроЪрпНроЪро░ро┐рокрпНрокрпБроорпН роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпБроорпН</th><th>роЪро░ро│роорпБроорпН роУроЪрпИроиропроорпБроорпН</th></tr></thead>
<tbody>
<tr><td>1</td><td>9-10</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">родрпЖро│ро┐ро╡ро╛рой роЙроЪрпНроЪро░ро┐рокрпНрокрпБ</li><li style="margin-left: 8px; text-indent: -4px;">родрпЖро│ро┐ро╡ро╛рой роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</li></ul></td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роЪрпАро░ро╛рой роЪро░ро│роорпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпКро░рпБродрпНродрооро╛рой роХрпБро░ро▓рпН роПро▒рпНро▒ роЗро▒роХрпНроХроорпН</li></ul></td></tr>
<tr><td>2</td><td>6-8</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роЪро┐ро▓ рокро┐ро┤рпИроХро│рпИ роороЯрпНроЯрпБроорпН роХрпКрогрпНроЯ роЙроЪрпНроЪро░ро┐рокрпНрокрпБ</li><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН родрпЖро│ро┐ро╡ро╛рой роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</li></ul></td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН роЪрпАро░ро╛рой роЪро░ро│роорпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН рокрпКро░рпБродрпНродрооро╛рой роХрпБро░ро▓рпН роПро▒рпНро▒ роЗро▒роХрпНроХроорпН</li></ul></td></tr>
<tr><td>3</td><td>3-5</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роОро│ро┐родро┐ро▓рпН роЕро▒ро┐ропроХрпН роХрпВроЯро┐роп рокро▓ рокро┐ро┤рпИроХро│рпИроХрпН роХрпКрогрпНроЯ роЙроЪрпНроЪро░ро┐рокрпНрокрпБ</li><li style="margin-left: 8px; text-indent: -4px;">роУро░ро│ро╡рпБ родрпЖро│ро┐ро╡ро╛рой роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</li></ul></td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роУро░ро│ро╡рпБ роЪро░ро│роорпН</li><li style="margin-left: 8px; text-indent: -4px;">роУро░ро│ро╡рпБ рокрпКро░рпБродрпНродрооро╛рой роХрпБро░ро▓рпН роПро▒рпНро▒ роЗро▒роХрпНроХроорпН</li></ul></td></tr>
<tr><td>4</td><td>1-2</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">родрпЖро│ро┐ро╡ро▒рпНро▒ роЙроЪрпНроЪро░ро┐рокрпНрокрпБ</li><li style="margin-left: 8px; text-indent: -4px;">родрпЖро│ро┐ро╡ро▒рпНро▒ роЪрпКро▓рпНро▓ро┤рпБродрпНродроорпН</li></ul></td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роЪро░ро│рооро▒рпНро▒ ро╡ро╛роЪро┐рокрпНрокрпБ</li><li style="margin-left: 8px; text-indent: -4px;">роХро┐роЯрпНроЯродрпНродроЯрпНроЯ родройро┐родрпНродройро┐роЪрпН роЪрпКро▓рпНро▓ро╛роХ ро╡ро╛роЪро┐родрпНродро▓рпН</li></ul></td></tr>
</tbody></table></div>
<div style="width: 100%;">
<div class="rubric-section-title">рокроХрпБродро┐ 2: роЙро░рпИропро╛роЯро▓рпН (40 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</div>
<table class="appendix-table conversation-table">
<thead><tr><th>роиро┐ро▓рпИ</th><th>роородро┐рокрпНрокрпЖрогрпНроХро│рпН</th><th>роХро░рпБродрпНродрпБро░рпИродрпНродро▓рпБроорпН роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ропрпБроорпН (20 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</th><th>роородро┐рокрпНрокрпЖрогрпНроХро│рпН</th><th>роЪро░ро│роорпБроорпН роорпКро┤ро┐рокрпН рокропройрпНрокро╛роЯрпБроорпН (20 роородро┐рокрпНрокрпЖрогрпНроХро│рпН)</th></tr></thead>
<tbody>
<tr><td>1</td><td>16-20</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">родро▓рпИрокрпНрокрпБроХрпНроХрпБ роПро▒рпНро▒ рокрпКро░рпБроирпНродрооро╛рой роХро░рпБродрпНродрпБроХро│рпИроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ родрпЖро│ро┐ро╡ро╛роХро╡рпБроорпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХро╡рпБроорпН роЗро░рпБродрпНродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпКро░рпБроирпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроЯройрпН роХро░рпБродрпНродрпБроХро│рпИ ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНродрпБродро▓рпН</li></ul></td><td>16-20</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роЪро░ро│рооро╛роХ роЙро░рпИропро╛роЯрпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпКро░рпБроирпНродрооро╛рой роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</li></ul></td></tr>
<tr><td>2</td><td>11-15</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН родро▓рпИрокрпНрокрпБроХрпНроХрпБ роПро▒рпНро▒ рокрпКро░рпБроирпНродрооро╛рой роХро░рпБродрпНродрпБроХро│ро╛роХроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН родрпЖро│ро┐ро╡ро╛роХро╡рпБроорпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХро╡рпБроорпН роЗро░рпБродрпНродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой роХро░рпБродрпНродрпБроХро│рпИрокрпН рокрпКро░рпБроирпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроЯройрпН ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой ро╡рпЗро│рпИроХро│ро┐ро▓рпН роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНродрпБродро▓рпН</li></ul></td><td>11-15</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роУро░ро│ро╡рпБ роЪро░ро│рооро╛роХ роЙро░рпИропро╛роЯрпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роУро░ро│ро╡рпБ рокрпКро░рпБроирпНродрооро╛рой роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН роОро│ро┐роп родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</li></ul></td></tr>
<tr><td>3</td><td>6-10</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роУро░ро│ро╡рпБ родро▓рпИрокрпНрокрпБроХрпНроХрпБ роПро▒рпНро▒ рокрпКро░рпБроирпНродрооро╛рой роХро░рпБродрпНродрпБроХро│ро╛роХроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ роУро░ро│ро╡рпБ родрпЖро│ро┐ро╡ро╛роХро╡рпБроорпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХро╡рпБроорпН роЗро░рпБродрпНродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роЪро┐ро▓ роХро░рпБродрпНродрпБроХро│рпИрокрпН рокрпКро░рпБроирпНродрооро╛рой роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроЯройрпН ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роЪро┐ро▓ ро╡рпЗро│рпИроХро│ро┐ро▓рпН роороЯрпНроЯрпБроорпЗ роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНродрпБродро▓рпН</li></ul></td><td>6-10</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">родропроХрпНроХродрпНродрпБроЯройрпН роЙро░рпИропро╛роЯрпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роЪро┐ро▒ро┐родрпБ рокрпКро░рпБроирпНродрооро▒рпНро▒ роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН роОро│ро┐роп родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</li></ul></td></tr>
<tr><td>4</td><td>1-5</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">рооро┐роХроХрпН роХрпБро▒рпИроирпНрод роХро░рпБродрпНродрпБроХро│рпИроХрпН роХрпВро▒рпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роХро░рпБродрпНродрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ роХрпБро▒рпИроирпНрод роЕро│ро╡ро┐ро▓рпН роЗро░рпБродрпНродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой роХро░рпБродрпНродрпБроХро│рпИ ро╡ро┐ро░ро┐ро╡ро╛роХроХрпН роХрпВро▒ роЗропро▓ро╛родро┐ро░рпБродрпНродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">роЙро░рпИропро╛роЯро▓рпИродрпН родрпКроЯро░рпНроЪрпНроЪро┐ропро╛роХ роиро┐роХро┤рпНродрпНрод роЗропро▓ро╛родро┐ро░рпБродрпНродро▓рпН</li></ul></td><td>1-5</td><td><ul style="padding-left: 14px; margin: 0;"><li style="margin-left: 8px; text-indent: -4px;">роЕродро┐роХродрпН родропроХрпНроХродрпНродрпБроЯройрпН роЙро░рпИропро╛роЯрпБродро▓рпН</li><li style="margin-left: 8px; text-indent: -4px;">рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН рокрпКро░рпБроирпНродрооро▒рпНро▒ роЪрпКро▓рпНро▓ро╛роЯрпНроЪро┐ропрпИропрпБроорпН роОро│ро┐роп родрпКроЯро░рпНроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН</li></ul></td></tr>
</tbody></table></div></div></div>`;
if (index < records.length - 1) html += '<div style="page-break-after: always;"></div>';
} else {
if (index < records.length - 1) html += '<div style="page-break-after: always;"></div>';
}
});
html += `</body></html>`;
const iframe = document.createElement('iframe');
iframe.style.position = 'absolute';
iframe.style.left = '-9999px';
iframe.style.width = '0';
iframe.style.height = '0';
iframe.style.border = 'none';
document.body.appendChild(iframe);
const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
iframeDoc.open();
iframeDoc.write(html);
if (isChrome) iframeDoc.body.classList.add('is-chrome');
iframeDoc.close();
iframe.onload = function() {
setTimeout(() => {
iframe.contentWindow.focus();
iframe.contentWindow.print();
setTimeout(() => { document.body.removeChild(iframe); }, 100);
}, 500);
};
}
function initCopyrightHover() {
const copyrightCorner = document.getElementById('copyright-corner');
if (!copyrightCorner) return;
let authorTextTimeout;
copyrightCorner.addEventListener('mouseenter', function() {
clearTimeout(authorTextTimeout);
this.classList.add('show-author');
authorTextTimeout = setTimeout(() => {
this.classList.remove('show-author');
this.classList.add('show-tooltip');
}, 800);
});
copyrightCorner.addEventListener('mouseleave', function() {
clearTimeout(authorTextTimeout);
this.classList.remove('show-author');
this.classList.remove('show-tooltip');
});
}
function exportConfig() {
alert('Fungsi eksport/import belum dilaksanakan sepenuhnya.');
}
function importConfig() {
alert('Fungsi eksport/import belum dilaksanakan sepenuhnya.');
}
document.addEventListener('DOMContentLoaded', () => {
init();
initCopyrightHover();
});
</script>
</body>
</html>